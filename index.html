<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>addMat - Additional materials</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">addMat</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#load-necessary-packages" id="toc-load-necessary-packages" class="nav-link" data-scroll-target="#load-necessary-packages">Load necessary packages</a></li>
  <li><a href="#step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir" id="toc-step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir" class="nav-link" data-scroll-target="#step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir">1) Step detection and Normalization of <strong>High-intensity Intermittent-fixed Submaximal Run (HI-IR)</strong></a>
  <ul class="collapse">
  <li><a href="#normalization" id="toc-normalization" class="nav-link" data-scroll-target="#normalization">Normalization</a></li>
  <li><a href="#normalising-fly-results" id="toc-normalising-fly-results" class="nav-link" data-scroll-target="#normalising-fly-results">Normalising fly results</a></li>
  </ul></li>
  <li><a href="#cross-correlations" id="toc-cross-correlations" class="nav-link" data-scroll-target="#cross-correlations">2) Cross Correlations</a></li>
  <li><a href="#within-athlete-variability-and-dose-response-effects" id="toc-within-athlete-variability-and-dose-response-effects" class="nav-link" data-scroll-target="#within-athlete-variability-and-dose-response-effects">3) Within Athlete variability and Dose response effects</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Additional materials</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Below is the statistical process followed to analyse results from the paper titled</p>
<p><strong>Variability, agreement and sensitivity of neuromuscular and cardiovascular response measures to weekly training load in professional Australian Football athletes.</strong></p>
<p><strong>Author Details:</strong> Adriano Arguedas-Soley<sup>1,2</sup>, Tzlil Shushan<sup>3</sup>, Andrew Murphy<sup>2,4</sup>, Nicholas Poulos<sup>2</sup>, Ric Lovell<sup>3</sup>, &amp; Dean Norris<sup>2</sup></p>
<p><sup>1</sup> School of Health Sciences, Western Sydney University, Sydney, NSW, Australia</p>
<p><sup>2</sup> High Performance Department, Greater Western Sydney (GWS) Giants Football Club, Sydney, NSW, Australia</p>
<p><sup>3</sup> Faculty of Science, Medicine and Health, University of Wollongong, Wollongong, NSW, Australia</p>
<p><sup>4</sup> School of Health Sciences, Robert Gordon University, Aberdeen, United Kingdom</p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This section will give a brief overview of analytic steps used:</p>
<ol type="1">
<li><p>Step detection and Normalization of High-intensity Intermittent-fixed Submaximal Run (HI-IR)</p></li>
<li><p>Cross correlations between outcome variables</p></li>
<li><p>Within subject variability &amp; Dose-responses associations to external load</p></li>
</ol>
</section>
<section id="load-necessary-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-necessary-packages">Load necessary packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"pacman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'pacman' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(data.table,lme4,mgcv,broom.mixed,mgcv,tidyverse,rmcorr,tidygraph,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>               igraph,ggraph,ggnetwork,stringr,gratia,emmeans,pracma,signal,DHARMa,performance,collapse,ggthemes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are unable to give access to complete raw data-sets but have uploaded de-identifed snippets so that the key processes could be replicated.</p>
</section>
<section id="step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir" class="level2">
<h2 class="anchored" data-anchor-id="step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir">1) Step detection and Normalization of <strong>High-intensity Intermittent-fixed Submaximal Run (HI-IR)</strong></h2>
<p>Prior to analysis, three trials were excludedï¿½from the study due to insufficient data. The exclusion criterion was set at a minimum of 6 steps identified during the constant velocity phase. This threshold was chosen to ensure at least three steps per leg were captured, which we deemed as bare minimum for accurate assessment of the collected parameters during constant velocity (44). Step identification was performed using vertical acceleration peaks from the 100Hz Inertial Measurement Unit (IMU) data. We employed a method described by Benson et al.&nbsp;(45), implemented using the <em>pracma</em> package. All identified peaks were visually inspected for each athlete-trial to ensure accuracy.</p>
<p>An example of this process is outlined below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>SD_url <span class="ot">&lt;-</span>  <span class="st">"https://raw.githubusercontent.com/R2mu/AdditionalMaterials/main/data_AddMat/exampleStepDetection.csv"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>stepDet<span class="ot">&lt;-</span><span class="fu">fread</span>(SD_url)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># find peaks algorithm</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># settings chosen were based of visual inspection that most reliable identified peaks in contact across all individuals. </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>find_peaks <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">minPeakHeight=</span><span class="fl">1.2</span>) {</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  peak_indices <span class="ot">&lt;-</span> pracma<span class="sc">::</span><span class="fu">findpeaks</span>(x, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">threshold =</span><span class="dv">0</span>, </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">minpeakdistance =</span> <span class="dv">16</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">minpeakheight =</span> minPeakHeight,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">zero =</span> <span class="st">"+"</span>)[, <span class="dv">2</span>]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  peak_indicator <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">seq_along</span>(x) <span class="sc">%in%</span> peak_indices) </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(peak_indicator)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># implementaion of find peaks across three sample players on a smoothed vertical acceleration signal can be seen below </span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering was performed using a 4th order 25 hz low pass butterworth filter</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>stepDet <span class="ot">&lt;-</span> stepDet[,bw<span class="fl">.25</span>_acc.up<span class="sc">:</span><span class="er">=</span><span class="fu">round</span>(<span class="fu">filtfilt</span>(<span class="fu">butter</span>(<span class="dv">1</span>,.<span class="dv">25</span>,<span class="at">type=</span><span class="st">"low"</span>), acc.up),<span class="dv">2</span>),by<span class="ot">=</span>.(ID)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                ][,peak<span class="sc">:</span><span class="er">=</span><span class="fu">find_peaks</span>(bw<span class="fl">.25</span>_acc.up,<span class="at">minPeakHeight =</span> <span class="fl">1.2</span>),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                   by<span class="ot">=</span>.(ID)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visual representation of step detection. This was performed for each testing occassion to ensure appropriate detection across all players.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stepDet,<span class="fu">aes</span>(time<span class="sc">/</span><span class="dv">60</span>,bw<span class="fl">.25</span>_acc.up))<span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(stepDet[peak<span class="sc">==</span><span class="dv">1</span>,],<span class="at">mapping=</span><span class="fu">aes</span>(time<span class="sc">/</span><span class="dv">60</span>,bw<span class="fl">.25</span>_acc.up),<span class="at">col=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID,<span class="at">ncol=</span><span class="dv">1</span>,<span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">strip.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x=</span> <span class="st">"time (s)"</span>,<span class="at">y =</span> <span class="fu">bquote</span>(<span class="sc">~</span>CF<span class="sc">-</span><span class="er">~</span>SMFT<span class="sc">~</span>PL[VT]))<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">geom_rangeframe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This was then summarised along with other key Player load derived measures to make sure a minimum of 6 steps was used for further analysis. Below is an example of how this was summarized for each player on each testing occasion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stepDet[peak<span class="sc">==</span><span class="dv">1</span>,.(<span class="at">count=</span>.N),by<span class="ot">=</span>.(ID)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ID count
1: #ID1    19
2: #ID2    21
3: #ID3    19</code></pre>
</div>
</div>
<section id="normalization" class="level3">
<h3 class="anchored" data-anchor-id="normalization">Normalization</h3>
<p>As both duration and velocity of the HI-IR<sub>plateau</sub> directly influence accumulated accelerometer-vector loads and were expected to vary from week-to-week, an adjusted estimate was developed. Below is an outline of the steps followed.</p>
<section id="load-and-split-data" class="level4">
<h4 class="anchored" data-anchor-id="load-and-split-data">Load and split data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>HIIR_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/R2mu/AdditionalMaterials/main/data_AddMat/HI_IR_data.csv"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#url</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>HIIR_dat<span class="ot">&lt;-</span><span class="fu">fread</span>(HIIR_url)[,ID       <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(ID)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>   ][,Season   <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(Season)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>   ][,logVT    <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">log</span>(pl.up_CV_SMF1),<span class="dv">3</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>   ][,logAP   <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">log</span>(pl.fwd_CV_SMF1),<span class="dv">3</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>   ][,logML  <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">log</span>(pl.side_CV_SMF1),<span class="dv">3</span>)]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(HIIR_dat), split <span class="sc">*</span> <span class="fu">nrow</span>(HIIR_dat))</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>test  <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(HIIR_dat), train)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> HIIR_dat[train, ]</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>test_data  <span class="ot">&lt;-</span> HIIR_dat[test, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-fully-specified-model" class="level4">
<h4 class="anchored" data-anchor-id="create-fully-specified-model">Create fully specified model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>adj_gam <span class="ot">&lt;-</span> <span class="fu">gam</span>(pl.up_CV_SMF1<span class="sc">~</span><span class="fu">te</span>(mu.vel_CV_SMF1,tm_CV_SMF1)<span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(GH)<span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(ID, mu.vel_CV_SMF1, <span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(Season, ID, <span class="at">bs =</span> <span class="st">"re"</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train_data)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>non_log <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(adj_gam,<span class="at">n=</span><span class="dv">1000</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(non_log,<span class="at">title=</span><span class="st">"Initial model response scale"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the above results we will refit with log transformation and also explore a simpler model along with the fully specified model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>adj.VT_null <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">log</span>(pl.up_CV_SMF1)<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(ID, mu.vel_CV_SMF1, <span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(Season,ID, <span class="at">bs =</span> <span class="st">"re"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train_data)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simpler RE structure</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>adj.VT_sml <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">log</span>(pl.up_CV_SMF1)<span class="sc">~</span><span class="fu">te</span>(mu.vel_CV_SMF1,tm_CV_SMF1)<span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(GH)<span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(ID, mu.vel_CV_SMF1, <span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(ID, <span class="at">bs=</span><span class="st">"re"</span>),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train_data)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># fully specified</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>adj.VT_fs <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">log</span>(pl.up_CV_SMF1)<span class="sc">~</span><span class="fu">te</span>(mu.vel_CV_SMF1,tm_CV_SMF1)<span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(GH)<span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(ID, mu.vel_CV_SMF1, <span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(Season,ID, <span class="at">bs =</span> <span class="st">"re"</span>),</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train_data)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>sim<span class="ot">=</span>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(adj.VT_sml,<span class="at">n=</span><span class="dv">1000</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim,<span class="at">title =</span> <span class="st">"Simple RE structure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sim<span class="ot">=</span>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(adj.VT_fs,<span class="at">n=</span><span class="dv">1000</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim,<span class="at">title =</span> <span class="st">"Full RE structure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="assess-models" class="level4">
<h4 class="anchored" data-anchor-id="assess-models">Assess models</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model_performance(adj.VT_fs)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(adj.VT_null,adj.VT_sml,adj.VT_fs,<span class="at">metrics =</span> <span class="st">"common"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name        | Model |  AIC (weights) |  BIC (weights) |    R2 |  RMSE
---------------------------------------------------------------------
adj.VT_null |   gam | 1131.0 (&lt;.001) | 1393.2 (&lt;.001) | 0.378 | 0.239
adj.VT_sml  |   gam |  305.6 (&lt;.001) |  598.2 (0.994) | 0.854 | 0.115
adj.VT_fs   |   gam |  197.2 (&gt;.999) |  608.6 (0.006) | 0.883 | 0.100</code></pre>
</div>
</div>
<p>Significant improvements from the null model to the fully specified are noted above, we which were also assessed on the hold out data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">null_model =</span> adj.VT_null,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sparse_re =</span> adj.VT_sml, <span class="co"># simplified random effects structure</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">full_re =</span> adj.VT_fs <span class="co"># maximal random effects structure</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># acc_AP = log_adj_AP, place holder for acc.fwd</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  acc_ML = log_adj_ML  place holder for acc.side</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (model_name <span class="cf">in</span> <span class="fu">names</span>(model_list)) {</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  current_model <span class="ot">&lt;-</span> model_list[[model_name]]</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>tst_dat <span class="ot">=</span> test_data[,preds<span class="sc">:</span><span class="er">=</span><span class="fu">predict</span>(current_model,.SD)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        ][<span class="sc">!</span><span class="fu">is.na</span>(preds),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        ][,diff_sq <span class="sc">:</span><span class="er">=</span> (logVT<span class="sc">-</span>preds)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        ]  </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">=</span> tst_dat[,.(<span class="at">RMSE=</span><span class="fu">sqrt</span>(<span class="fu">mean</span>(diff_sq)))]</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"test data RMSE for "</span>,model_name,<span class="st">": "</span>,<span class="fu">round</span>(rmse,<span class="dv">2</span>)))</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "test data RMSE for null_model: 0.25"
[1] "test data RMSE for sparse_re: 0.13"
[1] "test data RMSE for full_re: 0.12"</code></pre>
</div>
</div>
<p>While the full model exhibited a significant dispersion result, potentially indicating some over specification in the random effects structure, the remaining diagnostic measures were satisfactory. Given that our primary focus was on predictive performance and we believe that the full RE structure is more representative of the data at hand we stuck with the full RE model.</p>
<p>Predicted vs.&nbsp;Observed plot on hold out data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tst_dat,<span class="fu">aes</span>(logVT,preds))<span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">21</span>,<span class="at">fill=</span><span class="st">"gray80"</span>,<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>,<span class="at">intercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="sc">~</span>Measured<span class="sc">~</span>PL[VT]),<span class="at">y=</span><span class="fu">bquote</span>(<span class="sc">~</span>Predicted<span class="sc">~</span>PL[VT]))<span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rangeframe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="normalising-fly-results" class="level3">
<h3 class="anchored" data-anchor-id="normalising-fly-results">Normalising fly results</h3>
<p>First, we retrained the chosen model on the full data set, this was performed for each acceleration vector from the IMU.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>log_adj_VT_fin <span class="ot">&lt;-</span> <span class="fu">gam</span>(logVT<span class="sc">~</span><span class="fu">te</span>(mu.vel_CV_SMF1,tm_CV_SMF1)<span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(GH)<span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(ID, mu.vel_CV_SMF1, <span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(Season,ID, <span class="at">bs =</span> <span class="st">"re"</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> HIIR_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a reference data.frame with average values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ref_data<span class="ot">&lt;-</span><span class="fu">copy</span>(HIIR_dat)[,mu.vel_CV_SMF1 <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(mu.vel_CV_SMF1),<span class="dv">2</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       ][,tm_CV_SMF1      <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(tm_CV_SMF1),<span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>       ][,GH              <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(GH),<span class="dv">2</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>       ][,.(Season,ID,GH,nsteps_CV_SMF1,mu.vel_CV_SMF1,tm_CV_SMF1)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># create reference prediction based of average values</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>       ][,refPred_VT     <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">predict.gam</span>(log_adj_VT_fin,.SD),<span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># do some data cleaning for merging later</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>       ][,<span class="fu">setnames</span>(.SD,<span class="st">"mu.vel_CV_SMF1"</span>,<span class="st">"mu_vel"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>       ][,<span class="fu">setnames</span>(.SD,<span class="st">"tm_CV_SMF1"</span>,<span class="st">"mu_time"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>       ][,<span class="sc">!</span><span class="fu">c</span>(<span class="st">"GH"</span>,<span class="st">"nsteps_CV_SMF1"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a prediction grid based of observed values for that day</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ind_pred <span class="ot">=</span> HIIR_dat[,.(Season,ID,GH,nsteps_CV_SMF1,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                           pl.up_CV_SMF1,pl.fwd_CV_SMF1,pl.side_CV_SMF1,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                           mu.vel_CV_SMF1,tm_CV_SMF1,logVT),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>         <span class="co"># individual prediction: this would be extended fro AP and ML</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                      ][,indPred_VT   <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">predict.gam</span>(log_adj_VT_fin),<span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Join with reference prediction for normalisation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>HIIR_adj<span class="ot">=</span><span class="fu">join</span>(ind_pred,ref_data,<span class="at">how=</span><span class="st">"left"</span>,<span class="at">verbose=</span><span class="dv">0</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>       )[,logAdj_pl.VT   <span class="sc">:</span><span class="er">=</span> logVT   <span class="sc">-</span> (indPred_VT<span class="sc">-</span>refPred_VT)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visually represent the impact of adjustment on a subset of players</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">49</span>,<span class="dv">12</span>,<span class="at">replace =</span> F)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>examp_lng <span class="ot">&lt;-</span> HIIR_adj[,.(ID,logVT,logAdj_pl.VT,indPred_VT)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                    ][,<span class="fu">melt.data.table</span>(.SD,<span class="at">id.vars =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                    ][,variable<span class="sc">:</span><span class="er">=</span><span class="fu">ifelse</span>(variable<span class="sc">==</span><span class="st">"logAdj_pl.VT"</span>,<span class="st">"Post Adjustment"</span>,<span class="st">"Pre Adjustment"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                    ][ID<span class="sc">%in%</span>rs,]</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(examp_lng,<span class="fu">aes</span>(logVT,value,<span class="at">col=</span>variable))<span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,<span class="at">se=</span>F)<span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"measured VT_acc"</span>,<span class="at">y=</span><span class="st">"predicted VT_acc"</span>,<span class="at">title =</span> <span class="st">"Subset of adjustment example"</span>)<span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID)<span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From a global perspective we can notice the reduction in variance post adjustment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>HIIR_lng <span class="ot">&lt;-</span> HIIR_adj[,.(ID,logVT,logAdj_pl.VT)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                     ][,<span class="fu">melt.data.table</span>(.SD,<span class="at">id.vars =</span> <span class="dv">1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                     ][,variable<span class="sc">:</span><span class="er">=</span><span class="fu">ifelse</span>(variable<span class="sc">==</span><span class="st">"logAdj_pl.VT"</span>,<span class="st">"Post Adjustment"</span>,<span class="st">"Pre Adjustment"</span>)]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HIIR_lng,<span class="fu">aes</span>(<span class="at">x=</span>value,<span class="at">y=</span>variable,<span class="at">fill=</span>variable))<span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_sdl"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"crossbar"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.args =</span> <span class="fu">list</span>(<span class="at">mult=</span><span class="dv">1</span>),<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y=</span>.<span class="dv">2</span>),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">width=</span>.<span class="dv">1</span>,<span class="at">alpha=</span>.<span class="dv">3</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">pch=</span><span class="dv">21</span>,<span class="at">height =</span> <span class="fl">0.1</span>,<span class="at">alpha=</span>.<span class="dv">3</span>,<span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(PL[VT]), <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="cross-correlations" class="level2">
<h2 class="anchored" data-anchor-id="cross-correlations">2) Cross Correlations</h2>
<p>This section will outline how the within participate cross correlations were computed.</p>
<p>Load data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>crossCor_url<span class="ot">&lt;-</span><span class="st">"https://raw.githubusercontent.com/R2mu/AdditionalMaterials/main/data_AddMat/crossCor_data.csv"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>CrossCor_dat<span class="ot">&lt;-</span><span class="fu">fread</span>(crossCor_url)[,ID <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(ID)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Variables to use for cross correlations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>toi <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"value_"</span>,<span class="fu">c</span>(<span class="st">"ave_GB"</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ConPV_mx"</span>,<span class="st">"JHIM.mx"</span>,<span class="st">"FTCT.mx"</span>,<span class="st">"FZVmx"</span>,<span class="st">"EccDur.mn"</span>,<span class="st">"TTPP.mx"</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"tm_CV_SMF1"</span>,<span class="st">"mu.vel_CV_SMF1"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"logAdj_pl.up"</span>,<span class="st">"logAdj_pl.fwd"</span>,<span class="st">"logAdj_pl.side"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"HRmu_perc"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"pl.side_CV_SMR1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compute within participate correlation matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>crossCor<span class="ot">=</span><span class="fu">rmcorr_mat</span>(<span class="at">participant =</span> <span class="fu">as.factor</span>(ID),</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">variables =</span> toi,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dataset =</span>CrossCor_dat,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">CI.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Do some data cleaning for graphical represent cross correlations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>graphStrt <span class="ot">&lt;-</span> crossCor<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">sub</span>(<span class="st">"^value_"</span>, <span class="st">""</span>, .)),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"ave_GB"</span>,<span class="st">"ADD~Strength"</span>,.x)),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"logAdj_pl.up"</span>,<span class="st">"HI-IR~PL[V]"</span>,.x)),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"logAdj_pl.fwd"</span>,<span class="st">"HI-IR~PL[AP]"</span>,.x)),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"logAdj_pl.side"</span>,<span class="st">"HI-IR~PL[ML]"</span>,.x)),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"mu.vel_CV_SMF1"</span>,<span class="st">"HI-IR~Vel"</span>,.x)),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"tm_CV_SMF1"</span>,<span class="st">"HI-IR~Dur"</span>,.x)),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[AP]"</span>,.x)),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[V]"</span>,.x)),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"pl.side_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[ML]"</span>,.x)),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"HRmu_perc"</span>,<span class="st">"CF-SMFT~HR[ex]"</span>,.x)),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"TTPP.mx"</span>,<span class="st">"CMJ~TTPP"</span>,.x)),</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    across(c("measure1", "measure2"), ~ifelse(.x=="TTPF.mx","CMJ~TTPF",.x)),</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"EccDur.mn"</span>,<span class="st">"CMJ~Ecc~Dur"</span>,.x)),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"FZVmx"</span>,<span class="st">"CMJ~F0V"</span>,.x)),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"FTCT.mx"</span>,<span class="st">"CMJ~FT:CT"</span>,.x)),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"JHIM.mx"</span>,<span class="st">"CMJ~JH"</span>,.x)),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"ConPV_mx"</span>,<span class="st">"CMJ~Con~Vel"</span>,.x)),</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> rmcorr.r,  <span class="co"># Keep original r values</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_label =</span> <span class="fu">ifelse</span>(r <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> lowerCI <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">|</span> r <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> upperCI <span class="sc">&lt;</span> (<span class="sc">-</span><span class="fl">0.1</span>), <span class="fu">round</span>(r,<span class="dv">2</span>), <span class="cn">NA</span>)  <span class="co"># Create a new column for labels</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Turn into graph object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>graphCor <span class="ot">&lt;-</span>graphStrt<span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">graph_from_data_frame</span>(<span class="at">directed =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot network graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(graphCor,<span class="at">layout =</span> <span class="st">"circle"</span>) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge_alpha =</span> <span class="fu">abs</span>(r),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge_width =</span> <span class="fu">abs</span>(r), </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> r,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(r_label),<span class="st">""</span>,r_label)),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_size=</span><span class="dv">3</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"Times"</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lineend =</span> <span class="st">"round"</span>,<span class="at">linejoin =</span> <span class="st">"round"</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">edge_alpha =</span> <span class="st">"none"</span>, <span class="at">edge_width =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_colour_gradientn</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">8</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="dv">1</span>),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"firebrick2"</span>,<span class="st">"white"</span>,<span class="st">"dodgerblue2"</span>),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">name=</span><span class="st">"within participant correlation r"</span>) <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">color =</span> <span class="st">"gray70"</span>, <span class="at">size =</span> <span class="dv">5</span>,<span class="at">pch=</span><span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> name,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hjust =</span> <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">vjust =</span> <span class="fu">ifelse</span>(y <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.1</span>)),</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parse =</span> T,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha=</span>.<span class="dv">2</span>,</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">"Times"</span>,</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"lines"</span>),</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">label.r =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"lines"</span>)) <span class="sc">+</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.12</span>,<span class="fl">0.12</span>))<span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>,<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.text = element_text(),</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span>.<span class="dv">5</span>),</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">4</span>,<span class="at">units =</span> <span class="st">"lines"</span>),  <span class="co"># Adjust overall legend width</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="within-athlete-variability-and-dose-response-effects" class="level2">
<h2 class="anchored" data-anchor-id="within-athlete-variability-and-dose-response-effects">3) Within Athlete variability and Dose response effects</h2>
<p>See below an example of the process followed for quantifying the within athlete variability and fitting GAM models to assess dose response models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>DVOI_scaled <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"Zscr_BT_"</span>,<span class="fu">c</span>(<span class="st">"ave_GB"</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"JHIM.mx"</span>,<span class="st">"FZVmx"</span>,<span class="st">"FTCT.mx"</span>,<span class="st">"TTPP.mx"</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"tm_CV_SMF1"</span>,<span class="st">"mu.vel_CV_SMF1"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"logAdj_pl.up"</span>,<span class="st">"logAdj_pl.fwd"</span>,<span class="st">"logAdj_pl.side"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"HRmu_perc"</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"pl.side_CV_SMR1"</span>))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>DVOI <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"value_"</span>,<span class="fu">c</span>(<span class="st">"ave_GB"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"JHIM.mx"</span>,<span class="st">"FZVmx"</span>,<span class="st">"FTCT.mx"</span>,<span class="st">"TTPP.mx"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"tm_CV_SMF1"</span>,<span class="st">"mu.vel_CV_SMF1"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"logAdj_pl.up"</span>,<span class="st">"logAdj_pl.fwd"</span>,<span class="st">"logAdj_pl.side"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"HRmu_perc"</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"pl.side_CV_SMR1"</span>))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>cvte_url<span class="ot">&lt;-</span><span class="st">"https://raw.githubusercontent.com/R2mu/AdditionalMaterials/main/data_AddMat/CVTE_data.csv"</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>CVTE_dat <span class="ot">&lt;-</span> <span class="fu">fread</span>(cvte_url)[,ID <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(ID)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                 ][,Season<span class="sc">:</span><span class="er">=</span><span class="fu">as.factor</span>(Season)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(kableExtra,formattable, purrr)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>back_transform_mu <span class="ot">&lt;-</span> <span class="cf">function</span>(log_mean, log_sd) {</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute sigma squared</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  sigma_sq <span class="ot">&lt;-</span> log_sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the mean on the original scale</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  mean_original <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_mean <span class="sc">+</span> sigma_sq <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mean_original)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>back_transform_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(log_mean, log_sd) {</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute sigma squared</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  sigma_sq <span class="ot">&lt;-</span> log_sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the mean on the original scale</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  mean_original <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_mean <span class="sc">+</span> sigma_sq <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the residual SD on the original scale</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  sd_original <span class="ot">&lt;-</span> mean_original <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">exp</span>(sigma_sq) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sd_original)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>CV_TE  <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>plots  <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>edf    <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>emlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>cp     <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DVOI)) {</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>  DV_OI    <span class="ot">=</span> DVOI[i]</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>  DV_Zscr  <span class="ot">=</span> DVOI_scaled[i]</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null linear mixed effects models for TE estimation</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>  null_mod <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(DV_OI,<span class="st">'~1+(1|ID/Season)'</span>))</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>  mer1  <span class="ot">=</span> <span class="fu">lmer</span>(null_mod,<span class="at">data =</span> CVTE_dat)</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>  SDgrp <span class="ot">=</span> <span class="fu">VarCorr</span>(mer1)<span class="sc">|&gt;</span><span class="fu">data.frame</span>()<span class="sc">|&gt;</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">filter</span>(grp<span class="sc">==</span><span class="st">"ID"</span>)<span class="sc">|&gt;</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>          <span class="fu">pull</span>(sdcor)</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>  Resid <span class="ot">=</span> <span class="fu">VarCorr</span>(mer1)<span class="sc">|&gt;</span><span class="fu">data.frame</span>()<span class="sc">|&gt;</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">filter</span>(grp<span class="sc">==</span><span class="st">"Residual"</span>)<span class="sc">|&gt;</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>          <span class="fu">pull</span>(sdcor)</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a><span class="co"># GAM formulation</span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>  null_std <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(DV_Zscr,<span class="st">'~1+</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a><span class="st">                       s(ID, bs = "re")+</span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a><span class="st">                       s(Season, ID, bs = "re")'</span>))  </span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a> <span class="co"># GAM model</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a> form_zscr <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(DV_Zscr,<span class="st">'~</span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a><span class="st">                       s(Zscr_WI_TD_acu7,bs="gp")+</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a><span class="st">                       s(Zscr_WI_HIR_17_acu7,bs="gp")+</span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a><span class="st">                       s(Zscr_WI_VHSR_25_acu7,bs="gp")+</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a><span class="st">                       s(ID, bs = "re")+</span></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a><span class="st">                       s(Season, ID, bs = "re")'</span>))</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a> <span class="co"># GAM model scaled</span></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>gam_scaled <span class="ot">&lt;-</span> <span class="fu">bam</span>(form_zscr,     </span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> CVTE_dat,</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>                 <span class="at">discrete =</span> T,</span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"fREML"</span>,</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>                 <span class="at">select =</span> T)</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Zscr_WI_TD_acu7"</span>, <span class="st">"Zscr_WI_HIR_17_acu7"</span>, <span class="st">"Zscr_WI_VHSR_25_acu7"</span>)</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>process_variable <span class="ot">&lt;-</span> <span class="cf">function</span>(var_name) {</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the formula for emmeans</span></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>  formula_str <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"revpairwise ~ "</span>, var_name)</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get emmeans</span></span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>  em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a>    gam_scaled,</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.formula</span>(formula_str),</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">at =</span> <span class="fu">setNames</span>(<span class="fu">list</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)), var_name)</span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract emmean values</span></span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>  emmean_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(em<span class="sc">$</span>emmeans)<span class="sc">|&gt;</span></span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">all_of</span>(var_name), emmean)</span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a>  emmean_values <span class="ot">&lt;-</span> emmean_df<span class="sc">$</span>emmean</span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(emmean_values) <span class="ot">&lt;-</span> emmean_df[[var_name]]</span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get contrasts and process</span></span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a>  contrast_df <span class="ot">&lt;-</span> <span class="fu">summary</span>(em<span class="sc">$</span>contrasts, <span class="at">infer =</span> <span class="cn">TRUE</span>)<span class="sc">|&gt;</span></span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()<span class="sc">|&gt;</span></span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">contrast =</span> <span class="fu">word</span>(contrast, <span class="dv">1</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">-"</span>),</span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">contrast =</span> <span class="fu">str_sub</span>(contrast, <span class="at">end =</span> <span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-106"><a href="#cb32-106" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine emmean values with contrasts</span></span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a>  fin <span class="ot">&lt;-</span> contrast_df<span class="sc">|&gt;</span></span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">X1 =</span> emmean_values[<span class="fu">as.character</span>(<span class="sc">-</span><span class="dv">1</span>)],</span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">X2 =</span> emmean_values[<span class="fu">as.character</span>(<span class="dv">1</span>)]</span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(contrast, X1, X2, estimate, lower.CL, upper.CL, t.ratio, p.value)</span>
<span id="cb32-115"><a href="#cb32-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-116"><a href="#cb32-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fin)</span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-118"><a href="#cb32-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-119"><a href="#cb32-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-121"><a href="#cb32-121" aria-hidden="true" tabindex="-1"></a>emlist[[i]]<span class="ot">&lt;-</span><span class="fu">map_dfr</span>(vars, process_variable)<span class="sc">|&gt;</span></span>
<span id="cb32-122"><a href="#cb32-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DV =</span> DV_Zscr)<span class="sc">|&gt;</span></span>
<span id="cb32-123"><a href="#cb32-123" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(DV,<span class="at">.before =</span> contrast)</span>
<span id="cb32-124"><a href="#cb32-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a><span class="co"># for context against null model </span></span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a>gam_null <span class="ot">&lt;-</span> <span class="fu">bam</span>(null_std,     </span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> CVTE_dat,</span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a>                <span class="at">discrete =</span> T,</span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">"fREML"</span>,</span>
<span id="cb32-130"><a href="#cb32-130" aria-hidden="true" tabindex="-1"></a>                <span class="at">select =</span> T)</span>
<span id="cb32-131"><a href="#cb32-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a><span class="do">## extract GAM summary stats</span></span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a>sm <span class="ot">=</span><span class="fu">summary</span>(gam_scaled)</span>
<span id="cb32-135"><a href="#cb32-135" aria-hidden="true" tabindex="-1"></a>edf[[i]]<span class="ot">&lt;-</span>sm<span class="sc">$</span>s.table<span class="sc">|&gt;</span><span class="fu">data.frame</span>()<span class="sc">|&gt;</span></span>
<span id="cb32-136"><a href="#cb32-136" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"var"</span>)<span class="sc">|&gt;</span></span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">DV =</span> DV_Zscr)</span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a><span class="do">## Exatract smooth estimates</span></span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a>cp[[i]] <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(gam_scaled,</span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a>                            <span class="at">overall_uncertainty =</span> T,</span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a>                            <span class="at">unconditional =</span> T) <span class="sc">|&gt;</span></span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>(<span class="at">coverage =</span> .<span class="dv">95</span>)<span class="sc">|&gt;</span></span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>.type<span class="sc">==</span><span class="st">"Random effect"</span>)<span class="sc">|&gt;</span></span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.smooth,.estimate,.lower_ci,.upper_ci,</span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a>         Zscr_WI_TD_acu7,Zscr_WI_HIR_17_acu7,Zscr_WI_VHSR_25_acu7)<span class="sc">|&gt;</span></span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">id.vars=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">|&gt;</span></span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DV =</span> DV_Zscr)<span class="sc">|&gt;</span></span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">mean</span>(CVTE_dat[,<span class="fu">get</span>(DV_OI)],<span class="at">na.rm=</span>T)</span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">=</span> <span class="fu">sd</span>(CVTE_dat[,<span class="fu">get</span>(DV_OI)],<span class="at">na.rm=</span>T)</span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a><span class="do">## clean table</span></span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a>CV_TE[[i]]<span class="ot">&lt;-</span>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(mer1,<span class="at">effects=</span><span class="st">"ran_pars"</span>,</span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a>                  <span class="at">conf.int=</span>T,<span class="at">conf.method=</span><span class="st">"profile"</span>)<span class="sc">|&gt;</span></span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(group<span class="sc">==</span><span class="st">"Residual"</span>)<span class="sc">|&gt;</span></span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DV =</span> DV_OI,</span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a>         <span class="at">Ave =</span>  mu,</span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a>         <span class="at">SD  =</span>  sd,</span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a>         <span class="at">Ave =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">back_transform_mu</span>(mu,sd),Ave),</span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a>         <span class="at">SD =</span>  <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI), </span>
<span id="cb32-168"><a href="#cb32-168" aria-hidden="true" tabindex="-1"></a>               <span class="fu">back_transform_sd</span>(mu,sd),SD),</span>
<span id="cb32-169"><a href="#cb32-169" aria-hidden="true" tabindex="-1"></a>         <span class="at">Residual_te =</span> Resid,</span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Double check the below       </span></span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a>         <span class="at">Residual_te =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">back_transform_sd</span>(mu,Resid),Residual_te),</span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.low=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">back_transform_sd</span>(mu,conf.low),conf.low),</span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.high=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">back_transform_sd</span>(mu,conf.high),conf.high))<span class="sc">|&gt;</span></span>
<span id="cb32-178"><a href="#cb32-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CV =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),(<span class="fu">exp</span>(Resid) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb32-179"><a href="#cb32-179" aria-hidden="true" tabindex="-1"></a>              estimate<span class="sc">/</span>Ave<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a>         <span class="at">LL =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),(<span class="fu">exp</span>(conf.low) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a>              conf.low<span class="sc">/</span>Ave<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a>         <span class="at">UL =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),(<span class="fu">exp</span>(conf.high) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a>              conf.high<span class="sc">/</span>Ave<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a>         <span class="at">Null =</span> performance<span class="sc">::</span><span class="fu">rmse</span>(gam_null),</span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a>         <span class="at">Null =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb32-186"><a href="#cb32-186" aria-hidden="true" tabindex="-1"></a>         <span class="fu">back_transform_sd</span>(mu,performance<span class="sc">::</span><span class="fu">rmse</span>(gam_null)),Null),</span>
<span id="cb32-187"><a href="#cb32-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">Full  =</span> performance<span class="sc">::</span><span class="fu">rmse</span>(gam_scaled),</span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a>         <span class="at">Full =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a>        <span class="fu">back_transform_sd</span>(mu,performance<span class="sc">::</span><span class="fu">rmse</span>(gam_scaled)),Full))</span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(DVOI[i])</span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_ave_GB"
[1] "value_JHIM.mx"
[1] "value_FZVmx"
[1] "value_FTCT.mx"
[1] "value_TTPP.mx"
[1] "value_tm_CV_SMF1"
[1] "value_mu.vel_CV_SMF1"
[1] "value_logAdj_pl.up"
[1] "value_logAdj_pl.fwd"
[1] "value_logAdj_pl.side"
[1] "value_HRmu_perc"
[1] "value_pl.up_CV_SMR1"
[1] "value_pl.fwd_CV_SMR1"
[1] "value_pl.side_CV_SMR1"</code></pre>
</div>
</div>
<p><strong>Create example of Table 1.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(kableExtra)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbindlist</span>(CV_TE)<span class="sc">|&gt;</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round,<span class="dv">2</span>)<span class="sc">|&gt;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DV,Ave,SD,Residual_te,conf.low,conf.high,CV,LL,UL,Null,Full)<span class="sc">|&gt;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DV =</span> <span class="fu">case_when</span>(DV<span class="sc">==</span><span class="st">"value_ave_GB"</span><span class="sc">~</span><span class="st">"Adductor Strength (N)"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_JHIM.mx"</span><span class="sc">~</span><span class="st">"Jump height (cm)"</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_FZVmx"</span><span class="sc">~</span><span class="st">"Fz at 0v (N)"</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_FTCT.mx"</span><span class="sc">~</span><span class="st">"FT/CT"</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_TTPP.mx"</span><span class="sc">~</span><span class="st">"TTPP"</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_tm_CV_SMF1"</span><span class="sc">~</span><span class="st">"SMF Duration"</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_mu.vel_CV_SMF1"</span><span class="sc">~</span><span class="st">"SMF Velocity"</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_logAdj_pl.up"</span><span class="sc">~</span><span class="st">"SMF PL.VT"</span>,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_logAdj_pl.fwd"</span><span class="sc">~</span><span class="st">"SMF PL.AP"</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_logAdj_pl.side"</span><span class="sc">~</span><span class="st">"SMF PL.ML"</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_HRmu_perc"</span><span class="sc">~</span><span class="st">"CF-SMFT HR%"</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_pl.up_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.VT"</span>,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_pl.fwd_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.AP"</span>,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_pl.side_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.ML"</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                        ))<span class="sc">|&gt;</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()<span class="sc">|&gt;</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span>,<span class="st">"Descriptive"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"residual SD/TE"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"CV%"</span> <span class="ot">=</span> <span class="dv">3</span>,<span class="st">"RMSE"</span> <span class="ot">=</span> <span class="dv">2</span>))<span class="sc">|&gt;</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Groin Bar"</span>, <span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"CMJ"</span>, <span class="dv">2</span>, <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"HI-IR assessment"</span>, <span class="dv">6</span>, <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"CF-SMFT assessment"</span>,<span class="dv">11</span>, <span class="dv">14</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Descriptive
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
residual SD/TE
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
CV%
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
RMSE
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">DV</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ave</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Residual_te</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CV</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Null</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Full</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="1">
<td colspan="11" style="border-bottom: 1px solid"><strong>Groin Bar</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Adductor Strength (N)</td>
<td style="text-align: right;">478.30</td>
<td style="text-align: right;">82.75</td>
<td style="text-align: right;">32.64</td>
<td style="text-align: right;">31.47</td>
<td style="text-align: right;">33.89</td>
<td style="text-align: right;">6.82</td>
<td style="text-align: right;">6.58</td>
<td style="text-align: right;">7.09</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.39</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="11" style="border-bottom: 1px solid"><strong>CMJ</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Jump height (cm)</td>
<td style="text-align: right;">37.51</td>
<td style="text-align: right;">4.45</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">1.77</td>
<td style="text-align: right;">4.48</td>
<td style="text-align: right;">4.25</td>
<td style="text-align: right;">4.72</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.36</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Fz at 0v (N)</td>
<td style="text-align: right;">2408.31</td>
<td style="text-align: right;">459.24</td>
<td style="text-align: right;">145.29</td>
<td style="text-align: right;">137.91</td>
<td style="text-align: right;">153.36</td>
<td style="text-align: right;">6.03</td>
<td style="text-align: right;">5.73</td>
<td style="text-align: right;">6.37</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">FT/CT</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">7.14</td>
<td style="text-align: right;">6.77</td>
<td style="text-align: right;">7.53</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">TTPP</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">7.32</td>
<td style="text-align: right;">6.94</td>
<td style="text-align: right;">7.72</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even" data-grouplength="5">
<td colspan="11" style="border-bottom: 1px solid"><strong>HI-IR assessment</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF Duration</td>
<td style="text-align: right;">4.13</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">29.72</td>
<td style="text-align: right;">28.24</td>
<td style="text-align: right;">31.34</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.85</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF Velocity</td>
<td style="text-align: right;">24.93</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">2.43</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">9.75</td>
<td style="text-align: right;">9.25</td>
<td style="text-align: right;">10.29</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.84</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF PL.VT</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">11.24</td>
<td style="text-align: right;">29.90</td>
<td style="text-align: right;">33.86</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">1.61</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF PL.AP</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">14.06</td>
<td style="text-align: right;">20.13</td>
<td style="text-align: right;">22.77</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">1.27</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF PL.ML</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">15.01</td>
<td style="text-align: right;">21.76</td>
<td style="text-align: right;">24.64</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">1.45</td>
</tr>
<tr class="even" data-grouplength="4">
<td colspan="11" style="border-bottom: 1px solid"><strong>CF-SMFT assessment</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CF-SMFT HR%</td>
<td style="text-align: right;">76.22</td>
<td style="text-align: right;">4.40</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">2.83</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">3.72</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.54</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CF-SMFT PL.VT</td>
<td style="text-align: right;">19.59</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">1.58</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">8.04</td>
<td style="text-align: right;">7.60</td>
<td style="text-align: right;">8.53</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CF-SMFT PL.AP</td>
<td style="text-align: right;">9.21</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">10.59</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">11.23</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.54</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CF-SMFT PL.ML</td>
<td style="text-align: right;">8.91</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">12.12</td>
<td style="text-align: right;">11.45</td>
<td style="text-align: right;">12.85</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.56</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#kableExtra::kable_styling(bootstrap_options = c("hover"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>GAM summary table merged with marginal means</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>edf_bind <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(edf)<span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate_if</span>(is.numeric, round,<span class="dv">2</span>)<span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(DV,var,edf,F,p.value)<span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(F<span class="sc">&gt;=</span><span class="dv">3</span><span class="sc">&amp;!</span>var<span class="sc">==</span><span class="st">"s(ID)"</span><span class="sc">&amp;!</span>var<span class="sc">==</span><span class="st">"s(Season,ID)"</span>)<span class="sc">|&gt;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast=</span>var)<span class="sc">|&gt;</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">edf_pvalue=</span>p.value)<span class="sc">|&gt;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">contrast =</span>  <span class="fu">str_extract</span>(contrast, <span class="st">"(?&lt;=</span><span class="sc">\\</span><span class="st">().*(?=</span><span class="sc">\\</span><span class="st">))"</span>))<span class="sc">|&gt;</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">setDT</span>()</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>emm_bind <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(emlist)<span class="sc">|&gt;</span> </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate_if</span>(is.numeric, round,<span class="dv">2</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">join</span>(edf_bind,emm_bind)<span class="sc">|&gt;</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable</span>()<span class="sc">|&gt;</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">""</span>,<span class="st">""</span>,<span class="st">"gam summary"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"Estimated marginal means"</span> <span class="ot">=</span> <span class="dv">7</span>))<span class="sc">|&gt;</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>left join: edf_bind[DV, contrast] 9/9 (100%) &lt;m:m&gt; emm_bind[DV, contrast] 9/42 (21.4%)</code></pre>
</div>
<div class="cell-output-display">
<table class="lightable-paper table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
gam summary
</div></th>
<th colspan="7" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Estimated marginal means
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">DV</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edf_pvalue</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">X1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">X2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lower.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upper.CL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.ratio</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_JHIM.mx</td>
<td style="text-align: left;">Zscr_WI_TD_acu7</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">11.81</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">-4.57</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_FTCT.mx</td>
<td style="text-align: left;">Zscr_WI_TD_acu7</td>
<td style="text-align: right;">2.81</td>
<td style="text-align: right;">3.05</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-1.93</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_tm_CV_SMF1</td>
<td style="text-align: left;">Zscr_WI_HIR_17_acu7</td>
<td style="text-align: right;">6.35</td>
<td style="text-align: right;">5.39</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-1.05</td>
<td style="text-align: right;">0.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_mu.vel_CV_SMF1</td>
<td style="text-align: left;">Zscr_WI_TD_acu7</td>
<td style="text-align: right;">3.40</td>
<td style="text-align: right;">3.74</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-0.36</td>
<td style="text-align: right;">-0.50</td>
<td style="text-align: right;">-0.80</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">-3.24</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_mu.vel_CV_SMF1</td>
<td style="text-align: left;">Zscr_WI_HIR_17_acu7</td>
<td style="text-align: right;">6.51</td>
<td style="text-align: right;">8.35</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_HRmu_perc</td>
<td style="text-align: left;">Zscr_WI_TD_acu7</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">9.56</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">-0.57</td>
<td style="text-align: right;">-0.76</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">-5.99</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_HRmu_perc</td>
<td style="text-align: left;">Zscr_WI_HIR_17_acu7</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">3.38</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">2.90</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_pl.side_CV_SMR1</td>
<td style="text-align: left;">Zscr_WI_HIR_17_acu7</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">3.35</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">4.61</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_pl.side_CV_SMR1</td>
<td style="text-align: left;">Zscr_WI_VHSR_25_acu7</td>
<td style="text-align: right;">4.03</td>
<td style="text-align: right;">3.17</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-1.88</td>
<td style="text-align: right;">0.06</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Clean data for plotting</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pltDat<span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(cp)[,DV<span class="sc">:</span><span class="er">=</span><span class="fu">sub</span>(<span class="st">"^Zscr_BT_"</span>, <span class="st">""</span>, DV)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                     ][,DV<span class="sc">:</span><span class="er">=</span><span class="fu">fcase</span>(DV <span class="sc">==</span> <span class="st">"ave_GB"</span>,<span class="st">"~Adductor~Strength"</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"FZVmx"</span>,<span class="st">"CMJ~F0V"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"FTCT.mx"</span>,<span class="st">"CMJ~FT:CT"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"TTPP.mx"</span>,<span class="st">"CMJ~TTPP"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"JHIM.mx"</span>,<span class="st">"CMJ~JH"</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"mu.vel_CV_SMF1"</span>,<span class="st">"HI-IR~Vel"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"tm_CV_SMF1"</span>,<span class="st">"HI-IR~Dur"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"logAdj_pl.up"</span>,<span class="st">"HI-IR~PL[V]"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"logAdj_pl.fwd"</span>,<span class="st">"HI-IR~PL[AP]"</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"logAdj_pl.side"</span>,<span class="st">"HI-IR~PL[ML]"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"HRmu_perc"</span>,<span class="st">"CF-SMFT~HR[ex]"</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[V]"</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[AP]"</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"pl.side_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[ML]"</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>              <span class="co"># Dropped below for the sake of a 3*4 grid</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>                ][<span class="sc">!</span>DV<span class="sc">==</span><span class="st">"HI-IR~Dur"</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>CMJ dose response effects</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"CMJ"</span>,DV),],</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(value,.estimate,<span class="at">fill=</span>variable,<span class="at">col=</span>variable,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin=</span>.lower_ci,<span class="at">ymax=</span>.upper_ci))<span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span>.<span class="dv">3</span>,<span class="at">col=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>DV, <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Within participant scaled load"</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Between participant scaled response"</span>)<span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour=</span><span class="st">"gray30"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 600 rows containing missing values or values outside the scale range
(`geom_path()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>HI-IR dose repsonse</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"HI-IR"</span>,DV),],</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(value,.estimate,<span class="at">fill=</span>variable,<span class="at">col=</span>variable,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin=</span>.lower_ci,<span class="at">ymax=</span>.upper_ci))<span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span>.<span class="dv">3</span>,<span class="at">col=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>DV, <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Within participant scaled load"</span>,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Between participant scaled response"</span>)<span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour=</span><span class="st">"gray30"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 600 rows containing missing values or values outside the scale range
(`geom_path()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>CF - SMFT dose response</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"CF-SMFT"</span>,DV),],</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(value,.estimate,<span class="at">fill=</span>variable,<span class="at">col=</span>variable,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin=</span>.lower_ci,<span class="at">ymax=</span>.upper_ci))<span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span>.<span class="dv">3</span>,<span class="at">col=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>DV, <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Within participant scaled load"</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Between participant scaled response"</span>)<span class="sc">+</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour=</span><span class="st">"gray30"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 600 rows containing missing values or values outside the scale range
(`geom_path()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>