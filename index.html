<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Additional materials – addMat</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">



<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">addMat</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-necessary-packages" id="toc-load-necessary-packages" class="nav-link active" data-scroll-target="#load-necessary-packages">Load necessary packages</a></li>
  <li><a href="#outlier-detection" id="toc-outlier-detection" class="nav-link" data-scroll-target="#outlier-detection"><strong>Outlier detection</strong></a></li>
  <li><a href="#constant-velocity-identification" id="toc-constant-velocity-identification" class="nav-link" data-scroll-target="#constant-velocity-identification">1) Constant Velocity identification</a></li>
  <li><a href="#step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir" id="toc-step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir" class="nav-link" data-scroll-target="#step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir">2) Step detection and Normalization of <strong>High-intensity Intermittent-fixed Submaximal Run (HI-IR)</strong></a>
  <ul class="collapse">
  <li><a href="#normalization" id="toc-normalization" class="nav-link" data-scroll-target="#normalization">Normalization</a></li>
  <li><a href="#normalising-fly-results" id="toc-normalising-fly-results" class="nav-link" data-scroll-target="#normalising-fly-results">Normalising fly results</a></li>
  </ul></li>
  <li><a href="#cross-correlations" id="toc-cross-correlations" class="nav-link" data-scroll-target="#cross-correlations">3) Cross Correlations</a></li>
  <li><a href="#within-athlete-variability-and-load-response-effects" id="toc-within-athlete-variability-and-load-response-effects" class="nav-link" data-scroll-target="#within-athlete-variability-and-load-response-effects">4) Within Athlete Variability and Load Response Effects</a>
  <ul class="collapse">
  <li><a href="#a-sensitivity-analysis-for-gam-models." id="toc-a-sensitivity-analysis-for-gam-models." class="nav-link" data-scroll-target="#a-sensitivity-analysis-for-gam-models.">4a) Sensitivity analysis for GAM models.</a></li>
  </ul></li>
  <li><a href="#temporal-effects" id="toc-temporal-effects" class="nav-link" data-scroll-target="#temporal-effects">Temporal effects</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Additional materials</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Below is the statistical process followed to analyse results from the paper titled</p>
<p><strong>Divergent responses to training load in Football: Are Generic and Task-specific tools redundant or complementary?</strong></p>
<p>*Authorship will be updated once peer review process is completed</p>
<p>This section will give a brief overview of analytic steps used with reproducible examples:</p>
<ol type="1">
<li><p>Constant velocity identification</p></li>
<li><p>Step detection and Normalization of High-intensity Intermittent-fixed Submaximal Run (HI-IR)</p></li>
<li><p>Cross correlations between outcome variables</p></li>
<li><p>Within subject variability &amp; Dose-responses associations to external load</p></li>
</ol>
<section id="load-necessary-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-necessary-packages">Load necessary packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"pacman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(data.table,lme4,mgcv,broom.mixed,mgcv,tidyverse,rmcorr,tidygraph,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               igraph,ggraph,ggnetwork,stringr,gratia,emmeans,pracma,signal,DHARMa,performance,collapse,ggthemes,univOutl,pwr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are unable to give access to complete raw data-sets but have uploaded de-identifed snippets so that the key processes could be replicated.</p>
</section>
<section id="outlier-detection" class="level2">
<h2 class="anchored" data-anchor-id="outlier-detection"><strong>Outlier detection</strong></h2>
<p>To ensure data quality while preserving natural variability, we implemented a conservative outlier detection approach based on robust scale estimation (Qn method). Rather than relying on the standard deviation method, which can be heavily influenced by extreme values themselves (Rousseeuw &amp; Croux, 1993).</p>
<p>The Qn method works by calculating pairwise differences between observations and selecting a scaled quantile from these differences. This approach has been show to be a robust measure of dispersion that maintains resistance to contamination even when up to 50% of the data contains outliers, making it substantially more reliable than traditional methods in the presence of extreme values (Rousseeuw &amp; Croux, 1993)</p>
<p>For each subject and variable combination, we established outlier boundaries by:</p>
<p>Lower bound = Median - (2.75 � Qn scale) Upper bound = Median + (2.75 � Qn scale)</p>
<p>The multiplier of 2.75 was deliberately chosen to implement a conservative threshold that retains most natural variability while excluding only the most extreme observations. All observations that were flagged as potential outliers were scrutinized by domain experts to confirm before removal.</p>
<p>Rousseeuw, P. J., &amp; Croux, C. (1993). Alternatives to the Median Absolute Deviation.�<em>Journal of the American Statistical Association</em>,�<em>88</em>(424), 1273–1283. https://doi.org/10.1080/01621459.1993.10476408</p>
<p>Across all the variables analysed for future analysis, a range of 7 to 31 (0.91% to 4.13% of total observations for each test) observations were considered flags and subsequently removed prior to analysis.</p>
</section>
<section id="constant-velocity-identification" class="level2">
<h2 class="anchored" data-anchor-id="constant-velocity-identification">1) Constant Velocity identification</h2>
<p>Below shows steps used to identify constant velocity during the <strong>High-intensity Intermittent-fixed Submaximal Run (HI-IR).</strong> Constant velocity was consistent with the method outlined by Garret et al.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>phase_det_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/R2mu/AdditionalMaterials/main/data_AddMat/phasedetect_examp.csv"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>phase_data <span class="ot">&lt;-</span> <span class="fu">fread</span>(phase_det_url )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create function for detecting phases based on Garrett et a 2019</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>catphase_garrett <span class="ot">&lt;-</span> <span class="cf">function</span>(velocity,acceleration,rn,<span class="at">lowerlimit=</span><span class="sc">-</span><span class="fl">0.4</span>,<span class="at">upperlimit=</span><span class="fl">0.7</span>) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the index of peak acceleration</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  peak_acc_index <span class="ot">&lt;-</span> <span class="fu">which.max</span>(acceleration)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  first_index <span class="ot">&lt;-</span> <span class="fu">which</span>(acceleration[(peak_acc_index <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(acceleration)] <span class="sc">&lt;=</span> <span class="fl">0.7</span>)[<span class="dv">1</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  last_index <span class="ot">&lt;-</span> <span class="fu">which</span>(acceleration[(peak_acc_index <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(acceleration)] <span class="sc">&lt;=</span> (<span class="sc">-</span><span class="fl">0.4</span>))[<span class="dv">1</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  first_index <span class="ot">&lt;-</span> first_index <span class="sc">+</span> peak_acc_index</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  last_index  <span class="ot">&lt;-</span> peak_acc_index <span class="sc">+</span> last_index </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  val<span class="ot">=</span><span class="fu">ifelse</span>(velocity<span class="sc">&gt;=</span><span class="dv">2</span><span class="sc">&amp;</span>rn<span class="sc">*</span><span class="dv">100</span><span class="sc">&gt;=</span>first_index<span class="sc">&amp;</span>rn<span class="sc">*</span><span class="dv">100</span><span class="sc">&lt;=</span>last_index,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">"CV"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(rn<span class="sc">*</span><span class="dv">100</span><span class="sc">&lt;=</span>first_index,<span class="st">"AP"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(rn<span class="sc">*</span><span class="dv">100</span><span class="sc">&gt;=</span>last_index,<span class="st">"DP"</span>,<span class="cn">NA</span>)))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(val)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>phase_examp<span class="ot">=</span>phase_data [,vel_poly6 <span class="sc">:</span><span class="er">=</span><span class="fu">round</span>(<span class="fu">predict</span>(<span class="fu">lm</span>(vel_m.s <span class="sc">~</span> stats<span class="sc">::</span><span class="fu">poly</span>(rn,<span class="dv">6</span>)),.SD),<span class="dv">4</span>), </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                        by <span class="ot">=</span> .(ID)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                ][,poly_acc <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>((vel_poly6<span class="sc">-</span><span class="fu">shift</span>(vel_poly6,<span class="at">n =</span> <span class="dv">1</span>))<span class="sc">/</span><span class="fl">0.01</span>,<span class="dv">3</span>), by<span class="ot">=</span>.(ID)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                ][,phase_ID_garrett<span class="sc">:</span><span class="er">=</span> <span class="fu">catphase_garrett</span>(<span class="at">velocity =</span> vel_poly6,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">acceleration =</span>poly_acc,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">rn=</span>rn,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">lowerlimit =</span> (<span class="sc">-</span>.<span class="dv">4</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">upperlimit =</span> .<span class="dv">7</span>),by<span class="ot">=</span>.(ID)]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>rect<span class="ot">=</span> phase_examp[phase_ID_garrett<span class="sc">==</span><span class="st">"CV"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>         ][,.(<span class="at">start =</span><span class="fu">min</span>(rn),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">end=</span><span class="fu">max</span>(rn))]</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(phase_examp,<span class="fu">aes</span>(rn,vel_m.s))<span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"rect"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin=</span>rect<span class="sc">$</span>start,<span class="at">xmax =</span>rect<span class="sc">$</span>end,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin=</span><span class="sc">-</span><span class="cn">Inf</span>,<span class="at">ymax=</span><span class="cn">Inf</span>,<span class="at">fill=</span><span class="st">"green"</span>,<span class="at">alpha=</span>.<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">y=</span>vel_poly6,<span class="at">col=</span>phase_ID_garrett))<span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(.<span class="dv">7</span>,<span class="sc">-</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">y=</span>poly_acc,<span class="at">col=</span>phase_ID_garrett))<span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(phase_examp[phase_ID_garrett<span class="sc">==</span><span class="st">"CV"</span>,],</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping=</span><span class="fu">aes</span>(rn,acc.up))<span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,<span class="at">x=</span><span class="fl">3.2</span>,<span class="at">y=</span><span class="dv">3</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="st">"VT acceleration collected from accelerometer"</span>,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust=</span><span class="dv">0</span>,<span class="at">family=</span><span class="st">"Times"</span>)<span class="sc">+</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Time (s)"</span>, <span class="at">y =</span> <span class="fu">bquote</span>(<span class="st">"Velocity (m"</span><span class="sc">~</span><span class="st">"\u00B7"</span><span class="sc">~</span><span class="st">"s"</span><span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span><span class="st">")"</span>),</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>      <span class="co">#subtitle = "Black line represents VT accelerometer data",</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Constant Velocity Phase Detection"</span>)<span class="sc">+</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>),</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.line =</span> <span class="fu">element_line</span>(.<span class="dv">25</span>,<span class="at">colour=</span><span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Accelerometer data collected within the CV phase were then used to calculate player load calculations using formula outlined within the manuscript for all three vectors. Vertical accelerometer data was additionally used to calculate the number of steps that were achieved during the constant velocity phase, where the step detection method is outlined below.</p>
</section>
<section id="step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir" class="level2">
<h2 class="anchored" data-anchor-id="step-detection-and-normalization-of-high-intensity-intermittent-fixed-submaximal-run-hi-ir">2) Step detection and Normalization of <strong>High-intensity Intermittent-fixed Submaximal Run (HI-IR)</strong></h2>
<p>Prior to analysis, three trials were excluded from the study due to insufficient data. The exclusion criterion was set at a minimum of 6 steps identified during the constant velocity phase. This threshold was chosen to ensure at least three steps per leg were captured, which we deemed as bare minimum for accurate assessment of the collected parameters during constant velocity (44). Step identification was performed using vertical acceleration peaks from the 100Hz Inertial Measurement Unit (IMU) data. We employed components of a method described by Benson et al.&nbsp;(45), implemented using the <em>pracma</em> package. All identified peaks were visually inspected for each athlete-trial to ensure accuracy.</p>
<p>An example of this process is outlined below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>SD_url <span class="ot">&lt;-</span>  <span class="st">"https://raw.githubusercontent.com/R2mu/AdditionalMaterials/main/data_AddMat/exampleStepDetection.csv"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>stepDet<span class="ot">&lt;-</span><span class="fu">fread</span>(SD_url)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># find peaks algorithm</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># settings chosen were based of visual inspection that most reliable identified peaks in contact across all individuals. </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>find_peaks <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">minPeakHeight=</span><span class="fl">1.2</span>) {</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  peak_indices <span class="ot">&lt;-</span> pracma<span class="sc">::</span><span class="fu">findpeaks</span>(x, </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">threshold =</span><span class="dv">0</span>, </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">minpeakdistance =</span> <span class="dv">16</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">minpeakheight =</span> minPeakHeight,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">zero =</span> <span class="st">"+"</span>)[, <span class="dv">2</span>]</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  peak_indicator <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">seq_along</span>(x) <span class="sc">%in%</span> peak_indices) </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(peak_indicator)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># implementaion of find peaks across three sample players on a smoothed vertical acceleration signal can be seen below </span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering was performed using a 4th order 25 hz low pass butterworth filter</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>stepDet <span class="ot">&lt;-</span> stepDet[,bw<span class="fl">.25</span>_acc.up<span class="sc">:</span><span class="er">=</span><span class="fu">round</span>(<span class="fu">filtfilt</span>(<span class="fu">butter</span>(<span class="dv">1</span>,.<span class="dv">25</span>,<span class="at">type=</span><span class="st">"low"</span>), acc.up),<span class="dv">2</span>),by<span class="ot">=</span>.(ID)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                ][,peak<span class="sc">:</span><span class="er">=</span><span class="fu">find_peaks</span>(bw<span class="fl">.25</span>_acc.up,<span class="at">minPeakHeight =</span> <span class="fl">1.2</span>),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                   by<span class="ot">=</span>.(ID)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visual representation of step detection. This was performed for each testing occasion to ensure appropriate detection across all players.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stepDet,<span class="fu">aes</span>(time<span class="sc">/</span><span class="dv">60</span>,bw<span class="fl">.25</span>_acc.up))<span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(stepDet[peak<span class="sc">==</span><span class="dv">1</span>,],<span class="at">mapping=</span><span class="fu">aes</span>(time<span class="sc">/</span><span class="dv">60</span>,bw<span class="fl">.25</span>_acc.up),<span class="at">col=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID,<span class="at">ncol=</span><span class="dv">1</span>,<span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">strip.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x=</span> <span class="st">"time (s)"</span>,<span class="at">y =</span> <span class="fu">bquote</span>(<span class="sc">~</span>CF<span class="sc">-</span><span class="er">~</span>SMFT<span class="sc">~</span>PL[VT]))<span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">geom_rangeframe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This was then summarised along with other key Player load derived measures to make sure a minimum of 6 steps was used for further analysis. Below is an example of how this was summarized for each player on each testing occasion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>stepDet[peak<span class="sc">==</span><span class="dv">1</span>,.(<span class="at">count=</span>.N),by<span class="ot">=</span>.(ID)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID count
   &lt;char&gt; &lt;int&gt;
1:   #ID1    19
2:   #ID2    21
3:   #ID3    19</code></pre>
</div>
</div>
<section id="normalization" class="level3">
<h3 class="anchored" data-anchor-id="normalization">Normalization</h3>
<p>As both duration and velocity of the HI-IR<sub>plateau</sub> directly influence accumulated accelerometer-vector loads and were observed to vary from week-to-week, an adjusted estimate was developed. Below is an outline of the steps followed.</p>
<section id="load-and-split-data" class="level4">
<h4 class="anchored" data-anchor-id="load-and-split-data">Load and split data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>HIIR_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/R2mu/AdditionalMaterials/main/data_AddMat/HI_IR_data.csv"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#url</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>HIIR_dat<span class="ot">&lt;-</span><span class="fu">fread</span>(HIIR_url)[,ID       <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(ID)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>   ][,Season   <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(Season)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>   ][,logVT    <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">log</span>(pl.up_CV_SMF1),<span class="dv">3</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>   ][,logAP   <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">log</span>(pl.fwd_CV_SMF1),<span class="dv">3</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>   ][,logML  <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">log</span>(pl.side_CV_SMF1),<span class="dv">3</span>)]</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(HIIR_dat), split <span class="sc">*</span> <span class="fu">nrow</span>(HIIR_dat))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>test  <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(HIIR_dat), train)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> HIIR_dat[train, ]</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>test_data  <span class="ot">&lt;-</span> HIIR_dat[test, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-fully-specified-model" class="level4">
<h4 class="anchored" data-anchor-id="create-fully-specified-model">Create fully specified model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>adj_gam <span class="ot">&lt;-</span> <span class="fu">gam</span>(pl.up_CV_SMF1<span class="sc">~</span><span class="fu">te</span>(mu.vel_CV_SMF1,tm_CV_SMF1)<span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(GH)<span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(mu.vel_CV_SMF1,ID,<span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(Season, ID, <span class="at">bs =</span> <span class="st">"re"</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train_data)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>non_log <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(adj_gam,<span class="at">n=</span><span class="dv">1000</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(non_log,<span class="at">title=</span><span class="st">"Initial model response scale"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on the above results we will refit with log transformation and also explore a simpler model along with the fully specified model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>adj.VT_null <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">log</span>(pl.up_CV_SMF1)<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(mu.vel_CV_SMF1,ID, <span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(Season,ID, <span class="at">bs =</span> <span class="st">"re"</span>),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train_data)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simpler RE structure</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>adj.VT_sml <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">log</span>(pl.up_CV_SMF1)<span class="sc">~</span><span class="fu">te</span>(mu.vel_CV_SMF1,tm_CV_SMF1)<span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(GH)<span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(mu.vel_CV_SMF1,ID, <span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(ID, <span class="at">bs=</span><span class="st">"re"</span>),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train_data)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># fully specified</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>adj.VT_fs <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">log</span>(pl.up_CV_SMF1)<span class="sc">~</span><span class="fu">te</span>(mu.vel_CV_SMF1,tm_CV_SMF1)<span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(GH)<span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(mu.vel_CV_SMF1,ID, <span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(Season,ID, <span class="at">bs =</span> <span class="st">"re"</span>),</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train_data)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>sim<span class="ot">=</span>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(adj.VT_sml,<span class="at">n=</span><span class="dv">1000</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim,<span class="at">title =</span> <span class="st">"Simple RE structure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sim<span class="ot">=</span>DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(adj.VT_fs,<span class="at">n=</span><span class="dv">1000</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim,<span class="at">title =</span> <span class="st">"Full RE structure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="assess-models" class="level4">
<h4 class="anchored" data-anchor-id="assess-models">Assess models</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model_performance(adj.VT_fs)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(adj.VT_null,adj.VT_sml,adj.VT_fs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the nested models seem to be identical</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name        | Model |  AIC (weights) | AICc (weights) |  BIC (weights) |    R2
------------------------------------------------------------------------------
adj.VT_null |   gam | 1131.0 (&lt;.001) | 1145.3 (&lt;.001) | 1393.2 (&lt;.001) | 0.378
adj.VT_sml  |   gam |  305.6 (&lt;.001) |  323.7 (&lt;.001) |  598.2 (0.994) | 0.854
adj.VT_fs   |   gam |  197.2 (&gt;.999) |  234.8 (&gt;.999) |  608.6 (0.006) | 0.883

Name        |  RMSE | Sigma
---------------------------
adj.VT_null | 0.239 | 0.252
adj.VT_sml  | 0.115 | 0.122
adj.VT_fs   | 0.100 | 0.109</code></pre>
</div>
</div>
<p>Significant improvements from the null model to the fully specified are noted above, we which were also assessed on the hold out data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">null_model =</span> adj.VT_null,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sparse_re =</span> adj.VT_sml, <span class="co"># simplified random effects structure</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">full_re =</span> adj.VT_fs <span class="co"># maximal random effects structure</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># acc_AP = log_adj_AP, place holder for acc.fwd</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  acc_ML = log_adj_ML  place holder for acc.side</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (model_name <span class="cf">in</span> <span class="fu">names</span>(model_list)) {</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  current_model <span class="ot">&lt;-</span> model_list[[model_name]]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>tst_dat <span class="ot">=</span> test_data[,preds<span class="sc">:</span><span class="er">=</span><span class="fu">predict</span>(current_model,.SD)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        ][<span class="sc">!</span><span class="fu">is.na</span>(preds),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        ][,diff_sq <span class="sc">:</span><span class="er">=</span> (logVT<span class="sc">-</span>preds)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        ]  </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">=</span> tst_dat[,.(<span class="at">RMSE=</span><span class="fu">sqrt</span>(<span class="fu">mean</span>(diff_sq)))]</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"test data RMSE for "</span>,model_name,<span class="st">": "</span>,<span class="fu">round</span>(rmse,<span class="dv">2</span>)))</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "test data RMSE for null_model: 0.25"
[1] "test data RMSE for sparse_re: 0.13"
[1] "test data RMSE for full_re: 0.12"</code></pre>
</div>
</div>
<p>While the full model exhibited a significant dispersion result, potentially indicating some over specification in the random effects structure, the remaining diagnostic measures were satisfactory. Given that our primary focus was on predictive performance and we believe that the full RE structure is more representative of the data at hand we stuck with the full RE model.</p>
<p>Predicted vs.&nbsp;Observed plot on hold out data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tst_dat,<span class="fu">aes</span>(logVT,preds))<span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">21</span>,<span class="at">fill=</span><span class="st">"gray80"</span>,<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>,<span class="at">intercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="sc">~</span>Measured<span class="sc">~</span>PL[VT]),<span class="at">y=</span><span class="fu">bquote</span>(<span class="sc">~</span>Predicted<span class="sc">~</span>PL[VT]))<span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rangeframe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="normalising-fly-results" class="level3">
<h3 class="anchored" data-anchor-id="normalising-fly-results">Normalising fly results</h3>
<p>First, we retrained the chosen model on the full data set, this was performed for each acceleration vector from the IMU.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>log_adj_VT_fin <span class="ot">&lt;-</span> <span class="fu">gam</span>(logVT<span class="sc">~</span><span class="fu">te</span>(mu.vel_CV_SMF1,tm_CV_SMF1)<span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(GH)<span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                             <span class="do">## random effects matrix below</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(ID, mu.vel_CV_SMF1, <span class="at">bs=</span><span class="st">"re"</span>)<span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">s</span>(Season,ID, <span class="at">bs =</span> <span class="st">"re"</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> HIIR_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a reference data.frame with average values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ref_data<span class="ot">&lt;-</span><span class="fu">copy</span>(HIIR_dat)[,mu.vel_CV_SMF1 <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(mu.vel_CV_SMF1),<span class="dv">2</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>       ][,tm_CV_SMF1      <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(tm_CV_SMF1),<span class="dv">2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>       ][,GH              <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(GH),<span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>       ][,.(Season,ID,GH,nsteps_CV_SMF1,mu.vel_CV_SMF1,tm_CV_SMF1)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># create reference prediction based of average values</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>       ][,refPred_VT     <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">predict.gam</span>(log_adj_VT_fin,.SD),<span class="dv">2</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># do some data cleaning for merging later</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>       ][,<span class="fu">setnames</span>(.SD,<span class="st">"mu.vel_CV_SMF1"</span>,<span class="st">"mu_vel"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>       ][,<span class="fu">setnames</span>(.SD,<span class="st">"tm_CV_SMF1"</span>,<span class="st">"mu_time"</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>       ][,<span class="sc">!</span><span class="fu">c</span>(<span class="st">"GH"</span>,<span class="st">"nsteps_CV_SMF1"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a prediction grid based of observed values for that day</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ind_pred <span class="ot">=</span> HIIR_dat[,.(Season,ID,GH,nsteps_CV_SMF1,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                           pl.up_CV_SMF1,pl.fwd_CV_SMF1,pl.side_CV_SMF1,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                           mu.vel_CV_SMF1,tm_CV_SMF1,logVT),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>         <span class="co"># individual prediction: this would be extended fro AP and ML</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                      ][,indPred_VT   <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(<span class="fu">predict.gam</span>(log_adj_VT_fin),<span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Join with reference prediction for normalisation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>HIIR_adj<span class="ot">=</span><span class="fu">join</span>(ind_pred,ref_data,<span class="at">how=</span><span class="st">"left"</span>,<span class="at">verbose=</span><span class="dv">0</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>       )[,logAdj_pl.VT   <span class="sc">:</span><span class="er">=</span> logVT   <span class="sc">-</span> (indPred_VT<span class="sc">-</span>refPred_VT)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visually represent the impact of adjustment on a subset of players</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">49</span>,<span class="dv">12</span>,<span class="at">replace =</span> F)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>examp_lng <span class="ot">&lt;-</span> HIIR_adj[,.(ID,logVT,logAdj_pl.VT,indPred_VT)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                    ][,<span class="fu">melt.data.table</span>(.SD,<span class="at">id.vars =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                    ][,variable<span class="sc">:</span><span class="er">=</span><span class="fu">ifelse</span>(variable<span class="sc">==</span><span class="st">"logAdj_pl.VT"</span>,<span class="st">"Post Adjustment"</span>,<span class="st">"Pre Adjustment"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                    ][ID<span class="sc">%in%</span>rs,]</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(examp_lng,<span class="fu">aes</span>(logVT,value,<span class="at">col=</span>variable))<span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,<span class="at">se=</span>F)<span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"measured VT_acc"</span>,<span class="at">y=</span><span class="st">"predicted VT_acc"</span>,<span class="at">title =</span> <span class="st">"Subset of adjustment example"</span>)<span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID)<span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From a global perspective we can notice the reduction in variance post adjustment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>HIIR_lng <span class="ot">&lt;-</span> HIIR_adj[,.(ID,logVT,logAdj_pl.VT)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                     ][,<span class="fu">melt.data.table</span>(.SD,<span class="at">id.vars =</span> <span class="dv">1</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                     ][,variable<span class="sc">:</span><span class="er">=</span><span class="fu">ifelse</span>(variable<span class="sc">==</span><span class="st">"logAdj_pl.VT"</span>,<span class="st">"Post Adjustment"</span>,<span class="st">"Pre Adjustment"</span>)]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HIIR_lng,<span class="fu">aes</span>(<span class="at">x=</span>value,<span class="at">y=</span>variable,<span class="at">fill=</span>variable))<span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_sdl"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"crossbar"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.args =</span> <span class="fu">list</span>(<span class="at">mult=</span><span class="dv">1</span>),<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y=</span>.<span class="dv">2</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">width=</span>.<span class="dv">1</span>,<span class="at">alpha=</span>.<span class="dv">3</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">pch=</span><span class="dv">21</span>,<span class="at">height =</span> <span class="fl">0.1</span>,<span class="at">alpha=</span>.<span class="dv">3</span>,<span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(PL[VT]), <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cross-correlations" class="level2">
<h2 class="anchored" data-anchor-id="cross-correlations">3) Cross Correlations</h2>
<p>This section will outline how the within participate cross correlations were computed.</p>
<p>Load data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>crossCor_url<span class="ot">&lt;-</span><span class="st">"https://raw.githubusercontent.com/R2mu/AdditionalMaterials/main/data_AddMat/crossCor_db.csv"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>CrossCor_dat<span class="ot">&lt;-</span><span class="fu">fread</span>(crossCor_url)[,ID <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(ID)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Variables to use for cross correlations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>toi <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"value_"</span>,<span class="fu">c</span>(<span class="st">"ave_GB"</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ConPV_mx"</span>,<span class="st">"JHIM.mx"</span>,<span class="st">"FTCT.mx"</span>,<span class="st">"FZVmx"</span>,<span class="st">"EccDur.mn"</span>,<span class="st">"TTPP.mn"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"tm_CV_SMF1"</span>,<span class="st">"mu.vel_CV_SMF1"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"logAdj_pl.up"</span>,<span class="st">"logAdj_pl.fwd"</span>,<span class="st">"logAdj_pl.side"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"HRmu_perc"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"pl.side_CV_SMR1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compute within participate correlation matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>crossCor<span class="ot">=</span><span class="fu">rmcorr_mat</span>(<span class="at">participant =</span> <span class="fu">as.factor</span>(ID),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">variables =</span> toi,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dataset =</span>CrossCor_dat,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">CI.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>###3a) Sensitivity analysis</p>
<p>Using the above data and to help contenxtulise results we ran a sensitivity analysis to given an indicator of the smallest correlation we could observed with 80% pwoer and at a alpha of 0.05.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pwrRange <span class="ot">&lt;-</span> crossCor<span class="sc">$</span>summary<span class="sc">|&gt;</span><span class="fu">as.data.table</span>()</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>pwrRange[, .(measure1, measure2, effective.N)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>         ][<span class="fu">c</span>(<span class="fu">which.min</span>(effective.N), <span class="fu">which.max</span>(effective.N))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          measure1        measure2 effective.N
            &lt;char&gt;          &lt;char&gt;       &lt;num&gt;
1: value_EccDur.mn value_HRmu_perc         389
2:  value_ConPV_mx   value_JHIM.mx         829</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>  </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>target_power <span class="ot">&lt;-</span> <span class="fl">0.8</span>  </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>minEffN <span class="ot">&lt;-</span> <span class="dv">389</span> <span class="co">#lowest effective.N</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>maxEffN <span class="ot">&lt;-</span> <span class="dv">829</span> <span class="co">#Highest effective.N</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>muEffN <span class="ot">&lt;-</span> pwrRange[,.(<span class="at">muEffN=</span><span class="fu">mean</span>(effective.N))][[<span class="dv">1</span>]] <span class="co">#Mean effective n</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>EffN_rng <span class="ot">&lt;-</span> <span class="fu">c</span>(minEffN,muEffN,maxEffN)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>power_range <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(EffN_rng)) {</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> EffN_rng[j]</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  power_result <span class="ot">&lt;-</span> <span class="fu">pwr.r.test</span>(<span class="at">n =</span> i,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sig.level =</span> alpha,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">power =</span> target_power,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                             <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  power_range[[j]] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Effective N:"</span>, i, <span class="st">", MinDetectable r ="</span>, <span class="fu">round</span>(power_result<span class="sc">$</span>r, <span class="dv">2</span>))</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the clean list</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>power_range</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "Effective N: 389 , MinDetectable r = 0.14"

[[2]]
[1] "Effective N: 544.15 , MinDetectable r = 0.12"

[[3]]
[1] "Effective N: 829 , MinDetectable r = 0.1"</code></pre>
</div>
</div>
<p>Do some data cleaning for graphical represent cross correlations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>graphStrt <span class="ot">&lt;-</span> crossCor<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">sub</span>(<span class="st">"^value_"</span>, <span class="st">""</span>, .)),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"ave_GB"</span>,<span class="st">"ADD~Strength"</span>,.x)),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"logAdj_pl.up"</span>,<span class="st">"HI-IR~PL[V]"</span>,.x)),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"logAdj_pl.fwd"</span>,<span class="st">"HI-IR~PL[AP]"</span>,.x)),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"logAdj_pl.side"</span>,<span class="st">"HI-IR~PL[ML]"</span>,.x)),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"mu.vel_CV_SMF1"</span>,<span class="st">"HI-IR~Vel"</span>,.x)),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"tm_CV_SMF1"</span>,<span class="st">"HI-IR~Dur"</span>,.x)),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[AP]"</span>,.x)),</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[V]"</span>,.x)),</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"pl.side_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[ML]"</span>,.x)),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"HRmu_perc"</span>,<span class="st">"CF-SMFT~HR[ex]"</span>,.x)),</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"TTPP.mn"</span>,<span class="st">"CMJ~TTPP"</span>,.x)),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    across(c("measure1", "measure2"), ~ifelse(.x=="TTPF.mx","CMJ~TTPF",.x)),</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"EccDur.mn"</span>,<span class="st">"CMJ~Ecc~Dur"</span>,.x)),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"FZVmx"</span>,<span class="st">"CMJ~F0V"</span>,.x)),</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"FTCT.mx"</span>,<span class="st">"CMJ~FT:CT"</span>,.x)),</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"JHIM.mx"</span>,<span class="st">"CMJ~JH"</span>,.x)),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"measure1"</span>, <span class="st">"measure2"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="st">"ConPV_mx"</span>,<span class="st">"CMJ~Con~Vel"</span>,.x)),</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> rmcorr.r,  <span class="co"># Keep original r values</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_label =</span> <span class="fu">ifelse</span>(r <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> lowerCI <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">|</span> r <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> upperCI <span class="sc">&lt;</span> (<span class="sc">-</span><span class="fl">0.1</span>), <span class="fu">round</span>(r,<span class="dv">2</span>), <span class="cn">NA</span>)  <span class="co"># Create a new column for labels</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Turn into graph object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>graphCor <span class="ot">&lt;-</span>graphStrt<span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">graph_from_data_frame</span>(<span class="at">directed =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot network graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>networkFig<span class="ot">&lt;-</span>  <span class="fu">ggraph</span>(graphCor,<span class="at">layout =</span> <span class="st">"circle"</span>) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge_alpha =</span> <span class="fu">abs</span>(r),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge_width =</span> <span class="fu">abs</span>(r), </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> r,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(r_label),<span class="st">""</span>,r_label)),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_size=</span><span class="dv">3</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"Times"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lineend =</span> <span class="st">"round"</span>,<span class="at">linejoin =</span> <span class="st">"round"</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">edge_alpha =</span> <span class="st">"none"</span>, <span class="at">edge_width =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_colour_gradientn</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">8</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="dv">1</span>),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"firebrick2"</span>,<span class="st">"white"</span>,<span class="st">"dodgerblue2"</span>),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">name=</span><span class="st">"within participant correlation r"</span>) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">color =</span> <span class="st">"gray70"</span>, <span class="at">size =</span> <span class="dv">5</span>,<span class="at">pch=</span><span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> name,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hjust =</span> <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">vjust =</span> <span class="fu">ifelse</span>(y <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.1</span>)),</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parse =</span> T,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha=</span>.<span class="dv">2</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">"Times"</span>,</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"lines"</span>),</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">label.r =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"lines"</span>)) <span class="sc">+</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.12</span>,<span class="fl">0.12</span>))<span class="sc">+</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>,<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.text = element_text(),</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span>.<span class="dv">5</span>),</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">4</span>,<span class="at">units =</span> <span class="st">"lines"</span>),  <span class="co"># Adjust overall legend width</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>))</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>networkFig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(networkFig,filename="networkFig.png",dpi = 700,</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#       width = 8,height = 7,units = "in")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="within-athlete-variability-and-load-response-effects" class="level2">
<h2 class="anchored" data-anchor-id="within-athlete-variability-and-load-response-effects">4) Within Athlete Variability and Load Response Effects</h2>
<p>See below an example of the process followed for quantifying the within athlete variability and fitting GAM models to assess dose response models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>DVOI_scaled <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"Zscr_BT_"</span>,<span class="fu">c</span>(<span class="st">"ave_GB"</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"JHIM.mx"</span>,<span class="st">"FZVmx"</span>,<span class="st">"FTCT.mx"</span>,<span class="co">#"TTPP.mn",</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"tm_CV_SMF1"</span>,<span class="st">"mu.vel_CV_SMF1"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"logAdj_pl.up"</span>,<span class="st">"logAdj_pl.fwd"</span>,<span class="st">"logAdj_pl.side"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"HRmu_perc"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"pl.side_CV_SMR1"</span>))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>DVOI <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"value_"</span>,<span class="fu">c</span>(<span class="st">"ave_GB"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"JHIM.mx"</span>,<span class="st">"FZVmx"</span>,<span class="st">"FTCT.mx"</span>,<span class="co">#"TTPP.mn",</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"tm_CV_SMF1"</span>,<span class="st">"mu.vel_CV_SMF1"</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"logAdj_pl.up"</span>,<span class="st">"logAdj_pl.fwd"</span>,<span class="st">"logAdj_pl.side"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"HRmu_perc"</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"pl.side_CV_SMR1"</span>))</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>cvte_url<span class="ot">&lt;-</span><span class="st">"https://raw.githubusercontent.com/R2mu/AdditionalMaterials/main/data_AddMat/modelData.csv"</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>CVTE_dat <span class="ot">&lt;-</span> <span class="fu">fread</span>(cvte_url)[,ID <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(ID)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>                 ][,Season<span class="sc">:</span><span class="er">=</span><span class="fu">as.factor</span>(Season)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Please note for simplicity the code below is not in parallel and may take some time to run, this is mainly due to profile confidence intervals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(kableExtra,formattable, purrr,marginaleffects)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>back_transform_mu <span class="ot">&lt;-</span> <span class="cf">function</span>(log_mean, log_sd) {</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute sigma squared</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  sigma_sq <span class="ot">&lt;-</span> log_sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the mean on the original scale</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  mean_original <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_mean <span class="sc">+</span> sigma_sq <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mean_original)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>back_transform_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(log_mean, log_sd) {</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute sigma squared</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  sigma_sq <span class="ot">&lt;-</span> log_sd<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the mean on the original scale</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  mean_original <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_mean <span class="sc">+</span> sigma_sq <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the residual SD on the original scale</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  sd_original <span class="ot">&lt;-</span> mean_original <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">exp</span>(sigma_sq) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sd_original)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>CV_TE   <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>counts  <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>edf     <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>cp      <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>modperf <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>resid_str  <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>storeModel <span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>re_struc   <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DVOI)) {</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#i = 1</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>  DV_OI    <span class="ot">=</span> DVOI[i]</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>  DV_Zscr  <span class="ot">=</span> DVOI_scaled[i]</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>getcols <span class="ot">=</span><span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"Season"</span>,<span class="st">"Week"</span>,DV_OI)</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>count_df <span class="ot">=</span>CVTE_dat[<span class="sc">!</span><span class="fu">is.na</span>(Zscr_WI_TD_acu7),</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>][,..getcols</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>][<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">get</span>(DV_OI)),</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>][,.(<span class="at">cnt=</span>.N),by<span class="ot">=</span>.(ID,Season)</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>][,.(<span class="at">mu_count =</span> <span class="fu">mean</span>(cnt),</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>     <span class="at">sd_count =</span> <span class="fu">sd</span>(cnt),</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>     <span class="at">sm_count =</span> <span class="fu">sum</span>(cnt),</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>     <span class="at">nplayer=</span>.N),by<span class="ot">=</span>.(Season)]</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span>count_df[<span class="dv">1</span>,<span class="dv">4</span>][[<span class="dv">1</span>]]</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">=</span>count_df[<span class="dv">2</span>,<span class="dv">4</span>][[<span class="dv">1</span>]]</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>weighted_avg <span class="ot">&lt;-</span> <span class="fu">sum</span>(count_df<span class="sc">$</span>mu_count <span class="sc">*</span> <span class="fu">c</span>(n1,n2)) <span class="sc">/</span> (n1<span class="sc">+</span>n2)</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>pooled_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((n1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> count_df<span class="sc">$</span>sd_count[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (n2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> count_df<span class="sc">$</span>sd_count[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>counts[[i]]<span class="ot">&lt;-</span><span class="fu">data.table</span>(<span class="at">DV=</span>DV_OI,</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pooled_mu =</span> weighted_avg,</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pooled_sd =</span> pooled_sd)</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null linear mixed effects models for TE estimation</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>  null_mod <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(DV_OI,<span class="st">'~1+(Week||ID/Season)'</span>))</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>  mer1  <span class="ot">=</span> <span class="fu">lmer</span>(null_mod,<span class="at">data =</span> CVTE_dat,</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">lmerControl</span>(</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">optimizer =</span> <span class="st">"Nelder_Mead"</span>))                       </span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>  SDgrp <span class="ot">=</span> <span class="fu">VarCorr</span>(mer1)<span class="sc">|&gt;</span><span class="fu">data.frame</span>()<span class="sc">|&gt;</span></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">filter</span>(grp<span class="sc">==</span><span class="st">"ID"</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>          <span class="fu">pull</span>(sdcor)</span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>  Resid <span class="ot">=</span> <span class="fu">VarCorr</span>(mer1)<span class="sc">|&gt;</span><span class="fu">data.frame</span>()<span class="sc">|&gt;</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">filter</span>(grp<span class="sc">==</span><span class="st">"Residual"</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>          <span class="fu">pull</span>(sdcor)</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a><span class="co"># GAM formulation</span></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a><span class="co"># s(Week, ID, bs = "re") +</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a>null_std <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(DV_Zscr,<span class="st">'~1+</span></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a><span class="st">             s(ID, bs = "re") +               # Random intercept for ID</span></span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a><span class="st">             s(Week, ID, bs = "re") +         # Random slope for ID</span></span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a><span class="st">             s(Week, Season, ID, bs = "re")+  # Random slope for Season within ID</span></span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a><span class="st">             s(Season, ID, bs = "re")'</span>)       <span class="co"># Random intercept for Season within ID</span></span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a><span class="co">#s(Week, ID, by = Season,bs = "re")+ </span></span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a><span class="co">#s(Zscr_WI_HIR_17_acu7,bs="ts")+</span></span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a><span class="co"># GAM model</span></span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a>form_zscr <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(DV_Zscr,<span class="st">'~</span></span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a><span class="st">             s(Zscr_WI_TD_acu7,bs="ts")+</span></span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a><span class="st">             s(Zscr_WI_VHSR_25_acu7,bs="ts")+</span></span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a><span class="st">             s(Week,by=Season,bs="cs")+</span></span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a><span class="st">             s(ID, bs = "re") +               # Random intercept for ID</span></span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a><span class="st">             s(Week, ID, bs = "re") +         # Random slope for ID</span></span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a><span class="st">             s(Week, Season, ID, bs = "re")+  # Random slope for Season within ID</span></span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a><span class="st">             s(Season, ID, bs = "re")'</span>)       <span class="co"># Random intercept for Season within ID</span></span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a><span class="do">##       </span></span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a> <span class="co"># GAM model scaled</span></span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a>gam_scaled <span class="ot">&lt;-</span> <span class="fu">bam</span>(form_zscr,     </span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> CVTE_dat,</span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a>                 <span class="at">discrete =</span> T,</span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"fREML"</span>,</span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a>                 <span class="at">select =</span> T)</span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a>storeModel[[i]]<span class="ot">&lt;-</span>gam_scaled</span>
<span id="cb39-124"><a href="#cb39-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-125"><a href="#cb39-125" aria-hidden="true" tabindex="-1"></a>modperf[[i]]<span class="ot">&lt;-</span> <span class="fu">model_performance</span>(gam_scaled)<span class="sc">|&gt;</span></span>
<span id="cb39-126"><a href="#cb39-126" aria-hidden="true" tabindex="-1"></a>               <span class="fu">data.frame</span>()<span class="sc">|&gt;</span></span>
<span id="cb39-127"><a href="#cb39-127" aria-hidden="true" tabindex="-1"></a>               dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">DV =</span> DVOI_scaled[i])  </span>
<span id="cb39-128"><a href="#cb39-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-129"><a href="#cb39-129" aria-hidden="true" tabindex="-1"></a><span class="co">#"Zscr_WI_HIR_17_acu7",</span></span>
<span id="cb39-130"><a href="#cb39-130" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Zscr_WI_TD_acu7"</span>,<span class="st">"Zscr_WI_VHSR_25_acu7"</span>)</span>
<span id="cb39-131"><a href="#cb39-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-132"><a href="#cb39-132" aria-hidden="true" tabindex="-1"></a><span class="co"># for context against null model </span></span>
<span id="cb39-133"><a href="#cb39-133" aria-hidden="true" tabindex="-1"></a>gam_null <span class="ot">&lt;-</span> <span class="fu">bam</span>(null_std,</span>
<span id="cb39-134"><a href="#cb39-134" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> CVTE_dat,</span>
<span id="cb39-135"><a href="#cb39-135" aria-hidden="true" tabindex="-1"></a>               <span class="at">discrete =</span> T,</span>
<span id="cb39-136"><a href="#cb39-136" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"fREML"</span>)</span>
<span id="cb39-137"><a href="#cb39-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-138"><a href="#cb39-138" aria-hidden="true" tabindex="-1"></a><span class="co">#extract_vc(gam_null,digits = 3)[,c(1,2,4,5,6)]</span></span>
<span id="cb39-139"><a href="#cb39-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-140"><a href="#cb39-140" aria-hidden="true" tabindex="-1"></a><span class="do">## extract GAM summary stats</span></span>
<span id="cb39-141"><a href="#cb39-141" aria-hidden="true" tabindex="-1"></a>sm <span class="ot">=</span><span class="fu">summary</span>(gam_scaled)</span>
<span id="cb39-142"><a href="#cb39-142" aria-hidden="true" tabindex="-1"></a>edf[[i]]<span class="ot">&lt;-</span>sm<span class="sc">$</span>s.table<span class="sc">|&gt;</span><span class="fu">data.frame</span>()<span class="sc">|&gt;</span></span>
<span id="cb39-143"><a href="#cb39-143" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"var"</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-144"><a href="#cb39-144" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">DV =</span> DV_Zscr)</span>
<span id="cb39-145"><a href="#cb39-145" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb39-146"><a href="#cb39-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-147"><a href="#cb39-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract smooth estimates</span></span>
<span id="cb39-148"><a href="#cb39-148" aria-hidden="true" tabindex="-1"></a>cp[[i]] <span class="ot">&lt;-</span> <span class="fu">smooth_estimates</span>(gam_scaled,</span>
<span id="cb39-149"><a href="#cb39-149" aria-hidden="true" tabindex="-1"></a>                            <span class="at">unconditional =</span> T,</span>
<span id="cb39-150"><a href="#cb39-150" aria-hidden="true" tabindex="-1"></a>                            <span class="at">overall_uncertainty =</span> T) <span class="sc">|&gt;</span></span>
<span id="cb39-151"><a href="#cb39-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confint</span>(<span class="at">coverage =</span> .<span class="dv">95</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-152"><a href="#cb39-152" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>.type<span class="sc">==</span><span class="st">"Random effect"</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-153"><a href="#cb39-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.smooth,.estimate,.lower_ci,.upper_ci,</span>
<span id="cb39-154"><a href="#cb39-154" aria-hidden="true" tabindex="-1"></a>         Zscr_WI_TD_acu7,Zscr_WI_VHSR_25_acu7,Week)<span class="sc">|&gt;</span></span>
<span id="cb39-155"><a href="#cb39-155" aria-hidden="true" tabindex="-1"></a>  reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">id.vars=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-156"><a href="#cb39-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DV =</span> DV_Zscr)<span class="sc">|&gt;</span></span>
<span id="cb39-157"><a href="#cb39-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb39-158"><a href="#cb39-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-159"><a href="#cb39-159" aria-hidden="true" tabindex="-1"></a><span class="co">#resid[[i]] </span></span>
<span id="cb39-160"><a href="#cb39-160" aria-hidden="true" tabindex="-1"></a>resid<span class="ot">&lt;-</span> CVTE_dat[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">get</span>(DV_Zscr))<span class="sc">&amp;!</span><span class="fu">is.na</span>(Zscr_WI_TD_acu7),]<span class="sc">|&gt;</span></span>
<span id="cb39-161"><a href="#cb39-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_partial_residuals</span>(<span class="at">model =</span> gam_scaled)<span class="sc">|&gt;</span></span>
<span id="cb39-162"><a href="#cb39-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rn=</span><span class="fu">row_number</span>(),<span class="at">DV=</span> DV_Zscr,</span>
<span id="cb39-163"><a href="#cb39-163" aria-hidden="true" tabindex="-1"></a>         <span class="at">key =</span><span class="fu">paste0</span>(ID,<span class="st">"_"</span>,rn))<span class="sc">|&gt;</span></span>
<span id="cb39-164"><a href="#cb39-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(key,DV,Zscr_WI_TD_acu7,Zscr_WI_VHSR_25_acu7,</span>
<span id="cb39-165"><a href="#cb39-165" aria-hidden="true" tabindex="-1"></a>        <span class="st">"s(Zscr_WI_TD_acu7)"</span>, <span class="st">"s(Zscr_WI_VHSR_25_acu7)"</span>,</span>
<span id="cb39-166"><a href="#cb39-166" aria-hidden="true" tabindex="-1"></a>        <span class="st">"s(Week):Season2023"</span>,<span class="st">"s(Week):Season2024"</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-167"><a href="#cb39-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setDT</span>()</span>
<span id="cb39-168"><a href="#cb39-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-169"><a href="#cb39-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-170"><a href="#cb39-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-171"><a href="#cb39-171" aria-hidden="true" tabindex="-1"></a>resid_IV <span class="ot">&lt;-</span> resid[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb39-172"><a href="#cb39-172" aria-hidden="true" tabindex="-1"></a>          ][,<span class="fu">melt.data.table</span>(.SD,<span class="at">id.vars=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">variable.name =</span> <span class="st">"IV"</span>,<span class="at">value.name =</span> <span class="st">"IV_value"</span>)]</span>
<span id="cb39-173"><a href="#cb39-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-174"><a href="#cb39-174" aria-hidden="true" tabindex="-1"></a>resid_DV <span class="ot">&lt;-</span> resid[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb39-175"><a href="#cb39-175" aria-hidden="true" tabindex="-1"></a>          ][,<span class="fu">melt.data.table</span>(.SD,<span class="at">id.vars=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">variable.name =</span> <span class="st">"function"</span>,<span class="at">value.name =</span> <span class="st">"DV_value"</span>)]</span>
<span id="cb39-176"><a href="#cb39-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-177"><a href="#cb39-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-178"><a href="#cb39-178" aria-hidden="true" tabindex="-1"></a>resid_str[[i]]<span class="ot">&lt;-</span> <span class="fu">join</span>(resid_IV,resid_DV,<span class="at">how=</span><span class="st">"left"</span>)</span>
<span id="cb39-179"><a href="#cb39-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-180"><a href="#cb39-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-181"><a href="#cb39-181" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">mean</span>(CVTE_dat[,<span class="fu">get</span>(DV_OI)],<span class="at">na.rm=</span>T)</span>
<span id="cb39-182"><a href="#cb39-182" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">=</span> <span class="fu">sd</span>(CVTE_dat[,<span class="fu">get</span>(DV_OI)],<span class="at">na.rm=</span>T)</span>
<span id="cb39-183"><a href="#cb39-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-184"><a href="#cb39-184" aria-hidden="true" tabindex="-1"></a><span class="do">## clean table</span></span>
<span id="cb39-185"><a href="#cb39-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-186"><a href="#cb39-186" aria-hidden="true" tabindex="-1"></a>re_struc[[i]] <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(mer1,<span class="at">effects=</span><span class="st">"ran_pars"</span>,</span>
<span id="cb39-187"><a href="#cb39-187" aria-hidden="true" tabindex="-1"></a>                 <span class="at">conf.int=</span>T,<span class="at">conf.method=</span><span class="st">"profile"</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-188"><a href="#cb39-188" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">mutate</span>(<span class="at">DV =</span> DV_OI,</span>
<span id="cb39-189"><a href="#cb39-189" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Component =</span> <span class="fu">c</span>(</span>
<span id="cb39-190"><a href="#cb39-190" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Between-Season Trajectory (within athlete)"</span>,</span>
<span id="cb39-191"><a href="#cb39-191" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Between-Season Baseline (within athlete)"</span>, </span>
<span id="cb39-192"><a href="#cb39-192" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Between-Athlete Trajectory"</span>,</span>
<span id="cb39-193"><a href="#cb39-193" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Between-Athlete Baseline"</span>,</span>
<span id="cb39-194"><a href="#cb39-194" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Residual"</span>))</span>
<span id="cb39-195"><a href="#cb39-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-196"><a href="#cb39-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-197"><a href="#cb39-197" aria-hidden="true" tabindex="-1"></a>CV_TE[[i]]<span class="ot">&lt;-</span>re_struc[[i]]<span class="sc">|&gt;</span></span>
<span id="cb39-198"><a href="#cb39-198" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(group<span class="sc">==</span><span class="st">"Residual"</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-199"><a href="#cb39-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ave =</span>  mu,</span>
<span id="cb39-200"><a href="#cb39-200" aria-hidden="true" tabindex="-1"></a>         <span class="at">SD  =</span>  sd,</span>
<span id="cb39-201"><a href="#cb39-201" aria-hidden="true" tabindex="-1"></a>         <span class="at">Ave =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb39-202"><a href="#cb39-202" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">back_transform_mu</span>(mu,sd),Ave),</span>
<span id="cb39-203"><a href="#cb39-203" aria-hidden="true" tabindex="-1"></a>         <span class="at">SD =</span>  <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI), </span>
<span id="cb39-204"><a href="#cb39-204" aria-hidden="true" tabindex="-1"></a>               <span class="fu">back_transform_sd</span>(mu,sd),SD),</span>
<span id="cb39-205"><a href="#cb39-205" aria-hidden="true" tabindex="-1"></a>        <span class="at">Residual_te =</span> Resid,</span>
<span id="cb39-206"><a href="#cb39-206" aria-hidden="true" tabindex="-1"></a>        <span class="at">Residual_te =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb39-207"><a href="#cb39-207" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">back_transform_sd</span>(mu,Resid),Residual_te),</span>
<span id="cb39-208"><a href="#cb39-208" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.low =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb39-209"><a href="#cb39-209" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">back_transform_sd</span>(mu,conf.low),conf.low),</span>
<span id="cb39-210"><a href="#cb39-210" aria-hidden="true" tabindex="-1"></a>        <span class="at">conf.high=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb39-211"><a href="#cb39-211" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">back_transform_sd</span>(mu,conf.high),conf.high))<span class="sc">|&gt;</span></span>
<span id="cb39-212"><a href="#cb39-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CV =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"logAdj"</span>,DV_OI),</span>
<span id="cb39-213"><a href="#cb39-213" aria-hidden="true" tabindex="-1"></a>               Residual_te<span class="sc">/</span>Ave<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb39-214"><a href="#cb39-214" aria-hidden="true" tabindex="-1"></a>               estimate<span class="sc">/</span>Ave<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb39-215"><a href="#cb39-215" aria-hidden="true" tabindex="-1"></a>         <span class="at">LL =</span> conf.low<span class="sc">/</span>Ave<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb39-216"><a href="#cb39-216" aria-hidden="true" tabindex="-1"></a>         <span class="at">UL =</span> conf.high<span class="sc">/</span>Ave<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb39-217"><a href="#cb39-217" aria-hidden="true" tabindex="-1"></a>         <span class="at">Null =</span> performance<span class="sc">::</span><span class="fu">rmse</span>(gam_null),</span>
<span id="cb39-218"><a href="#cb39-218" aria-hidden="true" tabindex="-1"></a>         <span class="at">Full  =</span> performance<span class="sc">::</span><span class="fu">rmse</span>(gam_scaled))</span>
<span id="cb39-219"><a href="#cb39-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-220"><a href="#cb39-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-221"><a href="#cb39-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-222"><a href="#cb39-222" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(DVOI[i])</span>
<span id="cb39-223"><a href="#cb39-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-224"><a href="#cb39-224" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>left join: resid_IV[key, DV] 2974/2974 (100%) &lt;2:1st&gt; resid_DV[key, DV] 1487/5948 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_ave_GB"
left join: resid_IV[key, DV] 1772/1772 (100%) &lt;2:1st&gt; resid_DV[key, DV] 886/3544 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_JHIM.mx"
left join: resid_IV[key, DV] 1754/1754 (100%) &lt;2:1st&gt; resid_DV[key, DV] 877/3508 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_FZVmx"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>left join: resid_IV[key, DV] 1766/1766 (100%) &lt;2:1st&gt; resid_DV[key, DV] 883/3532 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_FTCT.mx"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>left join: resid_IV[key, DV] 1510/1510 (100%) &lt;2:1st&gt; resid_DV[key, DV] 755/3020 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_tm_CV_SMF1"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>left join: resid_IV[key, DV] 1508/1508 (100%) &lt;2:1st&gt; resid_DV[key, DV] 754/3016 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_mu.vel_CV_SMF1"
left join: resid_IV[key, DV] 1504/1504 (100%) &lt;2:1st&gt; resid_DV[key, DV] 752/3008 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_logAdj_pl.up"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>left join: resid_IV[key, DV] 1460/1460 (100%) &lt;2:1st&gt; resid_DV[key, DV] 730/2920 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_logAdj_pl.fwd"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>left join: resid_IV[key, DV] 1438/1438 (100%) &lt;2:1st&gt; resid_DV[key, DV] 719/2876 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_logAdj_pl.side"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>left join: resid_IV[key, DV] 1288/1288 (100%) &lt;2:1st&gt; resid_DV[key, DV] 644/2576 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_HRmu_perc"
left join: resid_IV[key, DV] 1330/1330 (100%) &lt;2:1st&gt; resid_DV[key, DV] 665/2660 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_pl.up_CV_SMR1"
left join: resid_IV[key, DV] 1320/1320 (100%) &lt;2:1st&gt; resid_DV[key, DV] 660/2640 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_pl.fwd_CV_SMR1"
left join: resid_IV[key, DV] 1334/1334 (100%) &lt;2:1st&gt; resid_DV[key, DV] 667/2668 (25%)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "value_pl.side_CV_SMR1"</code></pre>
</div>
</div>
<p><strong>Break down of residual variance from random effects (NULL MODEL)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>REstruct <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(re_struc) <span class="sc">|&gt;</span><span class="fu">mutate</span>(<span class="at">DV =</span> <span class="fu">case_when</span>(DV<span class="sc">==</span><span class="st">"value_ave_GB"</span><span class="sc">~</span><span class="st">"Adductor Strength (N)"</span>,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_JHIM.mx"</span><span class="sc">~</span><span class="st">"Jump height (cm)"</span>,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_FZVmx"</span><span class="sc">~</span><span class="st">"Fz at 0v (N)"</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_FTCT.mx"</span><span class="sc">~</span><span class="st">"FT/CT"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># DV=="value_TTPP.mn"~"TTPP",</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_tm_CV_SMF1"</span><span class="sc">~</span><span class="st">"SMF Duration"</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_mu.vel_CV_SMF1"</span><span class="sc">~</span><span class="st">"SMF Velocity"</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_logAdj_pl.up"</span><span class="sc">~</span><span class="st">"SMF PL.VT"</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_logAdj_pl.fwd"</span><span class="sc">~</span><span class="st">"SMF PL.AP"</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_logAdj_pl.side"</span><span class="sc">~</span><span class="st">"SMF PL.ML"</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_HRmu_perc"</span><span class="sc">~</span><span class="st">"CF-SMFT HR%"</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_pl.up_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.VT"</span>,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_pl.fwd_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.AP"</span>,</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_pl.side_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.ML"</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>                        ))<span class="sc">|&gt;</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Test =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"CF"</span>,DV),<span class="st">"CF-SMF"</span>,</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"SMF"</span>,DV),<span class="st">"SMF"</span>,</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Adductor"</span>,DV),<span class="st">"Groin Bar"</span>,<span class="st">"CMJ"</span>))))<span class="sc">|&gt;</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(DV)<span class="sc">|&gt;</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sumVar =</span> <span class="fu">sum</span>(estimate))<span class="sc">|&gt;</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()<span class="sc">|&gt;</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contribution =</span> estimate<span class="sc">/</span>sumVar<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(REstruct,<span class="fu">aes</span>(Component,DV,<span class="at">fill=</span>contribution,<span class="at">label=</span><span class="fu">round</span>(estimate,<span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">col=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">col=</span><span class="st">"white"</span>,<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Test<span class="sc">~</span>Component,<span class="at">scales =</span> <span class="st">"free"</span>,<span class="at">space =</span> <span class="st">"free"</span>,</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">label_wrap_gen</span>(<span class="at">multi_line =</span> T,<span class="at">width =</span> <span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>,<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Between-Athlete Baseline: How much athletes differ from each other in their overall score. e.g.&nbsp;the between athlete SD across athletes for Jump height is 4.2cm</p></li>
<li><p>Between athlete Trajectory: How much athletes differ from each other in their rate of change over the season.</p></li>
<li><p>Between-Season baseline (within athlete): How much an individuals average performance varies between seasons.</p></li>
<li><p>Between-Season trajectory (within athlete): How much an individual rate of change varies between seasons.</p></li>
<li><p>Residual: Remaining variation within an athlete-season after accounting for all other patterns (within-subject variability)</p></li>
</ul>
<p><strong>Create example of Table 1.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(kableExtra)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">rbindlist</span>(CV_TE)<span class="sc">|&gt;</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round,<span class="dv">2</span>)<span class="sc">|&gt;</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DV,Ave,SD,Residual_te,conf.low,conf.high,CV,LL,UL,Null,Full)<span class="sc">|&gt;</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DV =</span> <span class="fu">case_when</span>(DV<span class="sc">==</span><span class="st">"value_ave_GB"</span><span class="sc">~</span><span class="st">"Adductor Strength (N)"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_JHIM.mx"</span><span class="sc">~</span><span class="st">"Jump height (cm)"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_FZVmx"</span><span class="sc">~</span><span class="st">"Fz at 0v (N)"</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_FTCT.mx"</span><span class="sc">~</span><span class="st">"FT/CT"</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># DV=="value_TTPP.mn"~"TTPP",</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_tm_CV_SMF1"</span><span class="sc">~</span><span class="st">"SMF Duration"</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_mu.vel_CV_SMF1"</span><span class="sc">~</span><span class="st">"SMF Velocity"</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_logAdj_pl.up"</span><span class="sc">~</span><span class="st">"SMF PL.VT"</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_logAdj_pl.fwd"</span><span class="sc">~</span><span class="st">"SMF PL.AP"</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_logAdj_pl.side"</span><span class="sc">~</span><span class="st">"SMF PL.ML"</span>,</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_HRmu_perc"</span><span class="sc">~</span><span class="st">"CF-SMFT HR%"</span>,</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_pl.up_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.VT"</span>,</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_pl.fwd_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.AP"</span>,</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>                        DV<span class="sc">==</span><span class="st">"value_pl.side_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.ML"</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>                        ))<span class="sc">|&gt;</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()<span class="sc">|&gt;</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span>,<span class="st">"Descriptive"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"residual SD/TE"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"CV%"</span> <span class="ot">=</span> <span class="dv">3</span>,<span class="st">"RMSE"</span> <span class="ot">=</span> <span class="dv">2</span>))<span class="sc">|&gt;</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Groin Bar"</span>, <span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"CMJ"</span>, <span class="dv">2</span>, <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"HI-IR assessment"</span>, <span class="dv">5</span>, <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"CF-SMFT assessment"</span>,<span class="dv">10</span>, <span class="dv">13</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Descriptive
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
residual SD/TE
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
CV%
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
RMSE
</div></th>
</tr>
<tr class="even">
<th style="text-align: left;" data-quarto-table-cell-role="th">DV</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ave</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Residual_te</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CV</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">UL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Null</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Full</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="1">
<td colspan="11" style="border-bottom: 1px solid"><strong>Groin Bar</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Adductor Strength (N)</td>
<td style="text-align: right;">478.48</td>
<td style="text-align: right;">82.58</td>
<td style="text-align: right;">30.75</td>
<td style="text-align: right;">29.61</td>
<td style="text-align: right;">31.96</td>
<td style="text-align: right;">6.43</td>
<td style="text-align: right;">6.19</td>
<td style="text-align: right;">6.68</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.36</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="11" style="border-bottom: 1px solid"><strong>CMJ</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Jump height (cm)</td>
<td style="text-align: right;">37.73</td>
<td style="text-align: right;">4.44</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">4.27</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">4.50</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.31</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Fz at 0v (N)</td>
<td style="text-align: right;">2389.43</td>
<td style="text-align: right;">456.87</td>
<td style="text-align: right;">129.43</td>
<td style="text-align: right;">123.03</td>
<td style="text-align: right;">136.42</td>
<td style="text-align: right;">5.42</td>
<td style="text-align: right;">5.15</td>
<td style="text-align: right;">5.71</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.26</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">FT/CT</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">6.57</td>
<td style="text-align: right;">6.24</td>
<td style="text-align: right;">6.92</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.33</td>
</tr>
<tr class="odd" data-grouplength="5">
<td colspan="11" style="border-bottom: 1px solid"><strong>HI-IR assessment</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF Duration</td>
<td style="text-align: right;">4.13</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">29.17</td>
<td style="text-align: right;">27.74</td>
<td style="text-align: right;">30.73</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.69</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF Velocity</td>
<td style="text-align: right;">24.93</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">9.22</td>
<td style="text-align: right;">8.75</td>
<td style="text-align: right;">9.72</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.62</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF PL.VT</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">9.77</td>
<td style="text-align: right;">9.25</td>
<td style="text-align: right;">10.34</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.48</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF PL.AP</td>
<td style="text-align: right;">1.45</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">12.28</td>
<td style="text-align: right;">11.55</td>
<td style="text-align: right;">12.92</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.62</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SMF PL.ML</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">12.69</td>
<td style="text-align: right;">12.01</td>
<td style="text-align: right;">13.43</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.64</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="11" style="border-bottom: 1px solid"><strong>CF-SMFT assessment</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CF-SMFT HR%</td>
<td style="text-align: right;">76.36</td>
<td style="text-align: right;">4.43</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">3.66</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CF-SMFT PL.VT</td>
<td style="text-align: right;">19.65</td>
<td style="text-align: right;">3.46</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">1.58</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">8.50</td>
<td style="text-align: right;">8.02</td>
<td style="text-align: right;">9.04</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.48</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CF-SMFT PL.AP</td>
<td style="text-align: right;">9.19</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">10.61</td>
<td style="text-align: right;">10.02</td>
<td style="text-align: right;">11.26</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CF-SMFT PL.ML</td>
<td style="text-align: right;">8.96</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">11.53</td>
<td style="text-align: right;">10.86</td>
<td style="text-align: right;">12.27</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.53</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#kableExtra::kable_styling(bootstrap_options = c("hover"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>GAM summary table merged paramater effect</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>edf_bind <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(edf)<span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate_if</span>(is.numeric, round,<span class="dv">3</span>)<span class="sc">|&gt;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(DV,var,edf,F,p.value)<span class="sc">|&gt;</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>var<span class="sc">==</span><span class="st">"s(ID)"</span><span class="sc">&amp;!</span>var<span class="sc">==</span><span class="st">"s(Season,ID)"</span>)<span class="sc">|&gt;</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast=</span>var)<span class="sc">|&gt;</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">edf_pvalue=</span>p.value)<span class="sc">|&gt;</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">contrast =</span>  <span class="fu">str_extract</span>(contrast, <span class="st">"(?&lt;=</span><span class="sc">\\</span><span class="st">().*(?=</span><span class="sc">\\</span><span class="st">))"</span>))<span class="sc">|&gt;</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">setDT</span>()</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"s(Zscr_WI_TD_acu7)"</span>, <span class="st">"s(Zscr_WI_VHSR_25_acu7)"</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">=</span><span class="fu">rbindlist</span>(cp)[<span class="sc">!</span><span class="fu">is.na</span>(.estimate),</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>       ][.smooth<span class="sc">%in%</span>vars,</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>       ][<span class="sc">!</span><span class="fu">is.na</span>(value),</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>       ][,comb<span class="sc">:</span><span class="er">=</span><span class="fu">paste0</span>(DV,<span class="st">"_"</span>,variable)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># calculate maximum observed effect over smoothed range</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>       ][,zero<span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(.lower_ci<span class="sc">&lt;=</span><span class="dv">0</span><span class="sc">&amp;</span>.upper_ci<span class="sc">&gt;=</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)  </span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>       ][,.(<span class="at">min=</span><span class="fu">round</span>(<span class="fu">min</span>(.estimate),<span class="dv">2</span>),</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">max=</span><span class="fu">round</span>(<span class="fu">max</span>(.estimate),<span class="dv">2</span>),</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">CL_overlap=</span><span class="fu">max</span>(zero)),by<span class="ot">=</span>.(DV,variable)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>       ][,CL_overlap<span class="sc">:</span><span class="er">=</span><span class="fu">ifelse</span>(CL_overlap<span class="sc">==</span><span class="dv">1</span>,<span class="st">"No"</span>,<span class="st">"Yes"</span>)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>       ][,range<span class="sc">:</span><span class="er">=</span>max<span class="sc">-</span>min</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>       ][,.(DV,variable,range,CL_overlap)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>       ][,<span class="fu">setnames</span>(.SD,<span class="st">"variable"</span>,<span class="st">"contrast"</span>)]</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Show key variables who had signficant edf pvalue and effect size &gt;0.3</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>joined <span class="ot">&lt;-</span> <span class="fu">join</span>(edf_bind,rng)<span class="sc">|&gt;</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fsubset</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Week"</span>,contrast))<span class="sc">|&gt;</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fsubset</span>(edf_pvalue<span class="sc">&lt;</span><span class="fl">0.01</span>)<span class="co">#&amp;range&gt;=.3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>left join: edf_bind[DV, contrast] 26/78 (33.3%) &lt;1:1st&gt; rng[DV, contrast] 26/26 (100%)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#joined</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Show table</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>joined<span class="sc">|&gt;</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DV =</span> <span class="fu">case_when</span>(DV<span class="sc">==</span><span class="st">"Zscr_BT_ave_GB"</span><span class="sc">~</span><span class="st">"Adductor Strength (N)"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_JHIM.mx"</span><span class="sc">~</span><span class="st">"Jump height (cm)"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_FZVmx"</span><span class="sc">~</span><span class="st">"Fz at 0v (N)"</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_FTCT.mx"</span><span class="sc">~</span><span class="st">"FT/CT"</span>,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_TTPP.mn"</span><span class="sc">~</span><span class="st">"TTPP"</span>,</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_tm_CV_SMF1"</span><span class="sc">~</span><span class="st">"SMF Duration"</span>,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_mu.vel_CV_SMF1"</span><span class="sc">~</span><span class="st">"SMF Velocity"</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_logAdj_pl.up"</span><span class="sc">~</span><span class="st">"SMF PL.VT"</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_logAdj_pl.fwd"</span><span class="sc">~</span><span class="st">"SMF PL.AP"</span>,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_logAdj_pl.side"</span><span class="sc">~</span><span class="st">"SMF PL.ML"</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_HRmu_perc"</span><span class="sc">~</span><span class="st">"CF-SMFT HR%"</span>,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_pl.up_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.VT"</span>,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_pl.fwd_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.AP"</span>,</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>                       DV<span class="sc">==</span><span class="st">"Zscr_BT_pl.side_CV_SMR1"</span><span class="sc">~</span><span class="st">"CF-SMFT PL.ML"</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>                       ),</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">edf =</span> <span class="fu">round</span>(edf,<span class="dv">1</span>),</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">F =</span> <span class="fu">round</span>(F,<span class="dv">2</span>))<span class="sc">|&gt;</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable</span>()<span class="sc">|&gt;</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">""</span>,<span class="st">""</span>,<span class="st">"gam summary"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"effect"</span><span class="ot">=</span><span class="dv">2</span>))<span class="sc">|&gt;</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
gam summary
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
effect
</div></th>
</tr>
<tr class="even">
<th style="text-align: left;" data-quarto-table-cell-role="th">DV</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edf_pvalue</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">range</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">CL_overlap</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Jump height (cm)</td>
<td style="text-align: left;">Zscr_WI_TD_acu7</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">15.68</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fz at 0v (N)</td>
<td style="text-align: left;">Zscr_WI_TD_acu7</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">20.81</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SMF Velocity</td>
<td style="text-align: left;">Zscr_WI_VHSR_25_acu7</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">CF-SMFT HR%</td>
<td style="text-align: left;">Zscr_WI_TD_acu7</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CF-SMFT PL.AP</td>
<td style="text-align: left;">Zscr_WI_TD_acu7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.62</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">CF-SMFT PL.ML</td>
<td style="text-align: left;">Zscr_WI_TD_acu7</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">5.23</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: left;">No</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>|</p>
<p><strong>Clean data for plotting</strong></p>
<p>Key to filter for key variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>rm  <span class="ot">&lt;-</span> <span class="fu">paste0</span>(joined<span class="sc">$</span>DV,<span class="st">"_"</span>,joined<span class="sc">$</span>contrast)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>str <span class="ot">&lt;-</span> <span class="fu">paste</span>(rm, <span class="at">collapse =</span> <span class="st">"','"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>str <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"c('"</span>, str, <span class="st">"')"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create plotting data.frame</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>pltDat<span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(cp)[,comb<span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(DV,<span class="st">"_"</span>,variable)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#][comb%in%eval(parse(text = str)),</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                     ][,DV<span class="sc">:</span><span class="er">=</span><span class="fu">sub</span>(<span class="st">"^Zscr_BT_"</span>, <span class="st">""</span>, DV)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                     ][,DV<span class="sc">:</span><span class="er">=</span><span class="fu">fcase</span>(DV <span class="sc">==</span> <span class="st">"ave_GB"</span>,<span class="st">"~Adductor~Strength"</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"FZVmx"</span>,<span class="st">"CMJ~F0V"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"FTCT.mx"</span>,<span class="st">"CMJ~FT:CT"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"TTPP.mn"</span>,<span class="st">"CMJ~TTPP"</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"JHIM.mx"</span>,<span class="st">"CMJ~JH"</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"mu.vel_CV_SMF1"</span>,<span class="st">"HI-IR~Vel"</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"tm_CV_SMF1"</span>,<span class="st">"HI-IR~Dur"</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"logAdj_pl.up"</span>,<span class="st">"HI-IR~PL[VT]"</span>,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"logAdj_pl.fwd"</span>,<span class="st">"HI-IR~PL[AP]"</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"logAdj_pl.side"</span>,<span class="st">"HI-IR~PL[ML]"</span>,</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"HRmu_perc"</span>,<span class="st">"CF-SMFT~HR[ex]"</span>,</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[V]"</span>,</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[AP]"</span>,</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"pl.side_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[ML]"</span>)</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>              <span class="co"># Dropped below for the sake of a 3*4 grid</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>                ][<span class="sc">!</span>DV<span class="sc">==</span><span class="st">"HI-IR~Dur"</span>,</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>                ][,variable<span class="sc">:</span><span class="er">=</span><span class="fu">ifelse</span>(variable<span class="sc">==</span><span class="st">"Zscr_WI_TD_acu7"</span>,<span class="st">"~7~day~TD"</span>,</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(variable<span class="sc">==</span><span class="st">"Zscr_WI_VHSR_25_acu7"</span>,<span class="st">"7~day~VHSR"</span>,<span class="st">"Week"</span>)</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>                             )]</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>pltDat<span class="sc">$</span>variable<span class="ot">&lt;-</span><span class="fu">fct_relevel</span>(pltDat<span class="sc">$</span>variable, <span class="st">"~7~day~TD"</span>,</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"7~day~VHSR"</span>,</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Week"</span>)</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"s(Zscr_WI_TD_acu7)"</span>, <span class="st">"s(Zscr_WI_VHSR_25_acu7)"</span>)</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span><span class="fu">rbindlist</span>(resid_str)[,comb<span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(DV,<span class="st">"_"</span>,IV)</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#  ][comb%in%eval(parse(text = str)),</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>                      ][,DV<span class="sc">:</span><span class="er">=</span><span class="fu">sub</span>(<span class="st">"^Zscr_BT_"</span>, <span class="st">""</span>, DV)</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>                      ][,variable<span class="sc">:</span><span class="er">=</span><span class="fu">ifelse</span>(IV<span class="sc">==</span><span class="st">"Zscr_WI_TD_acu7"</span>,<span class="st">"~7~day~TD"</span>,</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(IV<span class="sc">==</span><span class="st">"Zscr_WI_VHSR_25_acu7"</span>,<span class="st">"7~day~VHSR"</span>,<span class="st">"Week"</span>))</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>                     ][,DV<span class="sc">:</span><span class="er">=</span><span class="fu">fcase</span>(DV <span class="sc">==</span> <span class="st">"ave_GB"</span>,<span class="st">"~Adductor~Strength"</span>,</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"FZVmx"</span>,<span class="st">"CMJ~F0V"</span>,</span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"FTCT.mx"</span>,<span class="st">"CMJ~FT:CT"</span>,</span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"TTPP.mn"</span>,<span class="st">"CMJ~TTPP"</span>,</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"JHIM.mx"</span>,<span class="st">"CMJ~JH"</span>,</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"mu.vel_CV_SMF1"</span>,<span class="st">"HI-IR~Vel"</span>,</span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"tm_CV_SMF1"</span>,<span class="st">"HI-IR~Dur"</span>,</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"logAdj_pl.up"</span>,<span class="st">"HI-IR~PL[VT]"</span>,</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"logAdj_pl.fwd"</span>,<span class="st">"HI-IR~PL[AP]"</span>,</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"logAdj_pl.side"</span>,<span class="st">"HI-IR~PL[ML]"</span>,</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"HRmu_perc"</span>,<span class="st">"CF-SMFT~HR[ex]"</span>,</span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"pl.up_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[V]"</span>,</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"pl.fwd_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[AP]"</span>,</span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a>                                  DV<span class="sc">==</span> <span class="st">"pl.side_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[ML]"</span>)</span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>              <span class="co"># Dropped below for the sake of a 3*4 grid</span></span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a>                ][<span class="sc">!</span>DV<span class="sc">==</span><span class="st">"HI-IR~Dur"</span>,]</span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a>residuals<span class="sc">$</span>variable<span class="ot">&lt;-</span><span class="fu">fct_relevel</span>(residuals<span class="sc">$</span>variable, <span class="st">"~7~day~TD"</span>, </span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"7~day~VHSR"</span>,</span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Week"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 unknown level in `f`: Week</code></pre>
</div>
</div>
<p><strong>Examine mean centered PDP/ Recreate effects figure1</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_load(ggalt)</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>pdpsum<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"rect"</span>,<span class="at">fill=</span><span class="st">"gray80"</span>,<span class="at">xmin=</span><span class="sc">-</span><span class="cn">Inf</span>,<span class="at">xmax =</span> <span class="cn">Inf</span>,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.3</span>,<span class="at">ymax=</span>.<span class="dv">3</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha=</span>.<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>),<span class="at">lwd=</span>.<span class="dv">25</span>)<span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_hline(yintercept = c(-.6,0.6),linetype="dashed")+</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = c(-2,-1,1,2),lwd=.25,alpha=.1)+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>),<span class="at">lwd=</span>.<span class="dv">25</span>,<span class="at">alpha=</span>.<span class="dv">9</span>)<span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> residuals[comb<span class="sc">%in%</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> str)),],<span class="at">alpha=</span>.<span class="dv">4</span>,<span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>IV_value,<span class="at">y=</span>DV_value),</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour=</span><span class="st">"#4e94ce"</span>)<span class="sc">+</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(pltDat[comb<span class="sc">%in%</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> str)),],</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">mapping=</span><span class="fu">aes</span>(value,<span class="at">ymin=</span>.lower_ci,<span class="at">ymax=</span>.upper_ci),</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="cn">NA</span>,<span class="at">alpha=</span>.<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(pltDat[comb<span class="sc">%in%</span><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> str)),],<span class="at">mapping=</span><span class="fu">aes</span>(value,<span class="at">y=</span>.estimate))<span class="sc">+</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(variable~DV,labeller =labeller(.default = label_parsed,</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     .multi_line = TRUE))+</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>DV<span class="sc">+</span>variable,<span class="at">nrow=</span><span class="dv">1</span>,</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>),<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.4</span>,<span class="fl">2.4</span>),</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="fl">1.2</span>,<span class="sc">-</span>.<span class="dv">6</span>,<span class="sc">-</span>.<span class="dv">3</span>,<span class="dv">0</span>,<span class="fl">0.3</span>,<span class="fl">0.6</span>,<span class="fl">1.2</span>,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_tufte</span>()<span class="sc">+</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Between athlete scaled response"</span>,<span class="at">x=</span><span class="st">"Within athlete scaled load"</span>)<span class="sc">+</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour =</span> <span class="st">"black"</span>))</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>pdpsum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 300 rows containing missing values or values outside the scale range
(`geom_path()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(pdpsum,width = 9,height = 3.2,filename="pdpsummaryIPsml_upd.png",dpi=800)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Post Hoc analysis</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="do">## SMFT observed effects</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>smft_hr<span class="ot">=</span>storeModel[[<span class="dv">10</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>( consec<span class="sc">~</span> Zscr_WI_TD_acu7, </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">var =</span><span class="st">"Zscr_WI_TD_acu7"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">at =</span> <span class="fu">list</span>(<span class="st">"Zscr_WI_TD_acu7"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>)),</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">cov.reduce=</span>F)<span class="sc">|&gt;</span><span class="fu">summary</span>(<span class="at">infer=</span>T)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co">#smft_hr$contrasts|&gt;clipr::write_clip()</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co">#smft_hr$emmeans|&gt;clipr::write_clip()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CF-SMFT PL AP</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co">#rise phase</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>smft_plup<span class="ot">=</span>storeModel[[<span class="dv">12</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(consec<span class="sc">~</span> Zscr_WI_TD_acu7, </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">var =</span><span class="st">"Zscr_WI_TD_acu7"</span>,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">at =</span> <span class="fu">list</span>(<span class="st">"Zscr_WI_TD_acu7"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>)),</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">cov.reduce=</span>F)<span class="sc">|&gt;</span><span class="fu">summary</span>(<span class="at">infer=</span>T)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co">#smft_plup$contrasts|&gt;clipr::write_clip()</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>smft_plup<span class="sc">$</span>emmeans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Zscr_WI_TD_acu7 emmean    SE  df lower.CL upper.CL t.ratio p.value
              -2 -0.299 0.165 557  -0.6233   0.0256  -1.809  0.0710
               0  0.145 0.119 557  -0.0897   0.3788   1.212  0.2259

Results are averaged over the levels of: Week, Season 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plateau phase</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>smft_plup<span class="ot">=</span>storeModel[[<span class="dv">12</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(consec<span class="sc">~</span> Zscr_WI_TD_acu7, </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">var =</span><span class="st">"Zscr_WI_TD_acu7"</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">at =</span> <span class="fu">list</span>(<span class="st">"Zscr_WI_TD_acu7"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>)),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">cov.reduce=</span>F)<span class="sc">|&gt;</span><span class="fu">summary</span>(<span class="at">infer=</span>T)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co">#smft_plup$contrasts|&gt;clipr::write_clip()</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>smft_plup<span class="sc">$</span>emmeans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Zscr_WI_TD_acu7   emmean    SE  df lower.CL upper.CL t.ratio p.value
               0  0.14458 0.119 557  -0.0897    0.379   1.212  0.2259
               2 -0.00603 0.160 557  -0.3197    0.308  -0.038  0.9699

Results are averaged over the levels of: Week, Season 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CF-SMFT PL ML</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#rise phase</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>smft_plup<span class="ot">=</span>storeModel[[<span class="dv">13</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(consec<span class="sc">~</span> Zscr_WI_TD_acu7, </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">var =</span><span class="st">"Zscr_WI_TD_acu7"</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">at =</span> <span class="fu">list</span>(<span class="st">"Zscr_WI_TD_acu7"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>)),</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">cov.reduce=</span>F)<span class="sc">|&gt;</span><span class="fu">summary</span>(<span class="at">infer=</span>T)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="co">#smft_plup$contrasts|&gt;clipr::write_clip()</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>smft_plup<span class="sc">$</span>emmeans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Zscr_WI_TD_acu7  emmean    SE  df lower.CL upper.CL t.ratio p.value
              -2 -0.5710 0.162 578   -0.889   -0.253  -3.522  0.0005
               0 -0.0398 0.112 578   -0.260    0.180  -0.355  0.7226

Results are averaged over the levels of: Week, Season 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plateau phase</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>smft_plup<span class="ot">=</span>storeModel[[<span class="dv">13</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(consec<span class="sc">~</span> Zscr_WI_TD_acu7, </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">var =</span><span class="st">"Zscr_WI_TD_acu7"</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">at =</span> <span class="fu">list</span>(<span class="st">"Zscr_WI_TD_acu7"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>)),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">cov.reduce=</span>F)<span class="sc">|&gt;</span><span class="fu">summary</span>(<span class="at">infer=</span>T)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co">#smft_plup$contrasts|&gt;clipr::write_clip()</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>smft_plup<span class="sc">$</span>emmeans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Zscr_WI_TD_acu7  emmean    SE  df lower.CL upper.CL t.ratio p.value
               0 -0.0398 0.112 578   -0.260   0.1802  -0.355  0.7226
               2 -0.2277 0.159 578   -0.541   0.0853  -1.429  0.1536

Results are averaged over the levels of: Week, Season 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">## HIIR effects</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>hiir_vel<span class="ot">=</span>storeModel[[<span class="dv">6</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(consec<span class="sc">~</span> Zscr_WI_VHSR_25_acu7, </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">var =</span><span class="st">"Zscr_WI_VHSR_25_acu7"</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">at =</span> <span class="fu">list</span>(<span class="st">"Zscr_WI_VHSR_25_acu7"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>)),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">cov.reduce=</span>F)<span class="sc">|&gt;</span><span class="fu">summary</span>(<span class="at">infer=</span>T)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co">#hiir_vel$contrasts|&gt;clipr::write_clip()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Groin bar effects</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> residuals[<span class="fu">grepl</span>(<span class="st">"Adductor"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],<span class="at">alpha=</span>.<span class="dv">4</span>,<span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>IV_value,<span class="at">y=</span>DV_value),</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour=</span><span class="st">"#4e94ce"</span>)<span class="sc">+</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"Adductor"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(value,.estimate,<span class="at">ymin=</span>.lower_ci,<span class="at">ymax=</span>.upper_ci),</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha=</span>.<span class="dv">5</span>,<span class="at">col=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"Adductor"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(value,.estimate))<span class="sc">+</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(DV),<span class="at">cols =</span> <span class="fu">vars</span>(variable),</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>   <span class="co">#  facet_wrap(~DV+variable,nrow=3,</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           labeller = label_parsed)+</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>   <span class="co"># theme_tufte()+</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>,<span class="fl">1.2</span>))<span class="sc">+</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Within participant scaled load"</span>,</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Between participant scaled response"</span>)<span class="sc">+</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>),</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour=</span><span class="st">"gray30"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>CMJ dose response effects</strong></p>
<p><strong>CMJ dose response</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> residuals[<span class="fu">grepl</span>(<span class="st">"CMJ"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],<span class="at">alpha=</span>.<span class="dv">4</span>,<span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>IV_value,<span class="at">y=</span>DV_value),</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour=</span><span class="st">"#4e94ce"</span>)<span class="sc">+</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"CMJ"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(value,.estimate,<span class="at">ymin=</span>.lower_ci,<span class="at">ymax=</span>.upper_ci),</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha=</span>.<span class="dv">5</span>,<span class="at">col=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"CMJ"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(value,.estimate))<span class="sc">+</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(DV),<span class="at">cols =</span> <span class="fu">vars</span>(variable),</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> label_parsed,<span class="at">scale=</span><span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>   <span class="co">#  facet_wrap(~DV+variable,nrow=3,</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           labeller = label_parsed)+</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>   <span class="co"># theme_tufte()+</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>,<span class="fl">1.2</span>))<span class="sc">+</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Within participant scaled load"</span>,</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Between participant scaled response"</span>)<span class="sc">+</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>),</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour=</span><span class="st">"gray30"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>HIIR dose response</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> residuals[<span class="fu">grepl</span>(<span class="st">"HI-IR"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],<span class="at">alpha=</span>.<span class="dv">4</span>,<span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>IV_value,<span class="at">y=</span>DV_value),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour=</span><span class="st">"#4e94ce"</span>)<span class="sc">+</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"HI-IR"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(value,.estimate,<span class="at">ymin=</span>.lower_ci,<span class="at">ymax=</span>.upper_ci),</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha=</span>.<span class="dv">5</span>,<span class="at">col=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"HI-IR"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(value,.estimate))<span class="sc">+</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(DV),<span class="at">cols =</span> <span class="fu">vars</span>(variable),</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>,<span class="fl">1.2</span>))<span class="sc">+</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Within participant scaled load"</span>,</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Between participant scaled response"</span>)<span class="sc">+</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>),</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour=</span><span class="st">"gray30"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>CF - SMFT dose response</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray70"</span>)<span class="sc">+</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,<span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">col=</span><span class="st">"gray7"</span>)<span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> residuals[<span class="fu">grepl</span>(<span class="st">"CF-SMFT"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],<span class="at">alpha=</span>.<span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>IV_value,<span class="at">y=</span>DV_value),</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour=</span><span class="st">"#4e94ce"</span>)<span class="sc">+</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"CF-SMFT"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(value,.estimate,<span class="at">ymin=</span>.lower_ci,<span class="at">ymax=</span>.upper_ci),</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha=</span>.<span class="dv">5</span>,<span class="at">col=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"CF-SMFT"</span>,DV)<span class="sc">&amp;!</span>variable<span class="sc">==</span><span class="st">"Week"</span>,],</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping=</span><span class="fu">aes</span>(value,.estimate))<span class="sc">+</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(DV),<span class="at">cols =</span> <span class="fu">vars</span>(variable),</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>   <span class="co">#  facet_wrap(~DV+variable,nrow=3,</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           labeller = label_parsed)+</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>   <span class="co"># theme_tufte()+</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>,<span class="fl">1.2</span>))<span class="sc">+</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Within participant scaled load"</span>,</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Between participant scaled response"</span>)<span class="sc">+</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">text=</span><span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>),</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour=</span><span class="st">"gray30"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="a-sensitivity-analysis-for-gam-models." class="level3">
<h3 class="anchored" data-anchor-id="a-sensitivity-analysis-for-gam-models.">4a) Sensitivity analysis for GAM models.</h3>
<p>Running a sensitivity analysis for a GAM model is not as straight forward as for a linear model as the potential functional form is not known apriori. Instead, to provide insight into the stability of our model estimates, we performed a post-hoc sensitivity analysis. Specifically, we refitted the final model to multiple random subsamples of the data. To help contextualise the model’s stability, we have plotted the resulting distributions of the p-values and the Effective Degrees of Freedom (EDF) for our key predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(doSNOW,foreach,doParallel,progress)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up variables</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>subject_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(CVTE_dat<span class="sc">$</span>ID)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>n_subjects <span class="ot">&lt;-</span> <span class="fu">length</span>(subject_ids)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>, <span class="dv">12</span>,<span class="dv">13</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>subsample_props <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>n_iterations <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dependent_var_index =</span> vars,</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> subsample_props,</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">iteration =</span> <span class="dv">1</span><span class="sc">:</span>n_iterations</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>)<span class="sc">|&gt;</span><span class="fu">mutate</span>(<span class="at">dependent_var_name =</span> DVOI_scaled[dependent_var_index])</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Helper function to run in parallel below</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>run_single_model <span class="ot">&lt;-</span> <span class="cf">function</span>(dv_name, proportion, iter_id) {</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set a seed for reproducibility</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(iter_id <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">+</span> proportion <span class="sc">*</span> <span class="dv">100</span>) </span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample subjects</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>  subsample_ids <span class="ot">&lt;-</span> <span class="fu">sample</span>(subject_ids, </span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="fu">floor</span>(n_subjects <span class="sc">*</span> proportion), </span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>  sub_dat <span class="ot">&lt;-</span> CVTE_dat[ID <span class="sc">%in%</span> subsample_ids, ]</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Build and run the model</span></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>  formula_str <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dv_name, <span class="st">'~ s(Zscr_WI_TD_acu7,bs="ts")+</span></span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a><span class="st">                        s(Zscr_WI_VHSR_25_acu7,bs="ts")+</span></span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a><span class="st">                        s(Week,by=Season,bs="cs")+</span></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a><span class="st">                        s(ID, bs = "re")+</span></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a><span class="st">                        s(Week, ID, bs = "re")+</span></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a><span class="st">                        s(Week, Season, ID, bs = "re")+</span></span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a><span class="st">                        s(Season, ID, bs = "re")'</span>)</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>  gam_subsample <span class="ot">&lt;-</span> <span class="fu">bam</span>(<span class="fu">as.formula</span>(formula_str), </span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> sub_dat, </span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">discrete =</span> <span class="cn">TRUE</span>, </span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">"fREML"</span>, </span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">select =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract results and add metadata</span></span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>  summary_df <span class="ot">&lt;-</span> <span class="fu">summary</span>(gam_subsample)<span class="sc">$</span>s.table <span class="sc">%&gt;%</span></span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"var"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">iteration =</span> iter_id,</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">sample_proportion =</span> proportion,</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">dependent_var =</span> dv_name</span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(summary_df)</span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a><span class="do">## set up for parallel processing</span></span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a>NCKF <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># number of cores to keep free (update based on your computer)</span></span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> NCKF)</span>
<span id="cb87-66"><a href="#cb87-66" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoSNOW</span>(cl) <span class="co"># needs to be DoSnow for progress bar</span></span>
<span id="cb87-67"><a href="#cb87-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-68"><a href="#cb87-68" aria-hidden="true" tabindex="-1"></a><span class="co"># create progress bar function</span></span>
<span id="cb87-69"><a href="#cb87-69" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">&lt;-</span> progress_bar<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb87-70"><a href="#cb87-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"Simulating [:bar] :percent | ETA: :eta"</span>,</span>
<span id="cb87-71"><a href="#cb87-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">total =</span> <span class="fu">nrow</span>(param_grid),</span>
<span id="cb87-72"><a href="#cb87-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb87-73"><a href="#cb87-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-74"><a href="#cb87-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-75"><a href="#cb87-75" aria-hidden="true" tabindex="-1"></a>progress_opts <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">progress =</span> <span class="cf">function</span>(n) pb<span class="sc">$</span><span class="fu">tick</span>())</span>
<span id="cb87-76"><a href="#cb87-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-77"><a href="#cb87-77" aria-hidden="true" tabindex="-1"></a><span class="co"># set up and run</span></span>
<span id="cb87-78"><a href="#cb87-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-79"><a href="#cb87-79" aria-hidden="true" tabindex="-1"></a>final_results_df <span class="ot">&lt;-</span> <span class="fu">foreach</span>(</span>
<span id="cb87-80"><a href="#cb87-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(param_grid),</span>
<span id="cb87-81"><a href="#cb87-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">.combine =</span> <span class="st">'rbind'</span>,</span>
<span id="cb87-82"><a href="#cb87-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">'mgcv'</span>, <span class="st">'dplyr'</span>, <span class="st">'tibble'</span>, <span class="st">'data.table'</span>),</span>
<span id="cb87-83"><a href="#cb87-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">.export =</span> <span class="fu">c</span>(<span class="st">'run_single_model'</span>, <span class="st">'subject_ids'</span>, <span class="st">'n_subjects'</span>, <span class="st">'CVTE_dat'</span>),</span>
<span id="cb87-84"><a href="#cb87-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">.options.snow =</span> progress_opts</span>
<span id="cb87-85"><a href="#cb87-85" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%dopar%</span> {</span>
<span id="cb87-86"><a href="#cb87-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-87"><a href="#cb87-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get parameters and run the model</span></span>
<span id="cb87-88"><a href="#cb87-88" aria-hidden="true" tabindex="-1"></a>  dv_name    <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>dependent_var_name[i]</span>
<span id="cb87-89"><a href="#cb87-89" aria-hidden="true" tabindex="-1"></a>  proportion <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>prop[i]</span>
<span id="cb87-90"><a href="#cb87-90" aria-hidden="true" tabindex="-1"></a>  iter_id    <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>iteration[i]</span>
<span id="cb87-91"><a href="#cb87-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-92"><a href="#cb87-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">run_single_model</span>(dv_name, proportion, iter_id)</span>
<span id="cb87-93"><a href="#cb87-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-94"><a href="#cb87-94" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in e$fun(obj, substitute(ex), parent.frame(), e$data): already
exporting variable(s): run_single_model, subject_ids, n_subjects, CVTE_dat</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CLOSE CLUSTER</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co">#"</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span><span class="fu">setDT</span>(final_results_df)[,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  dv <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_ave_GB"</span>,       <span class="st">"~Adductor~Strength"</span>,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_JHIM.mx"</span>,      <span class="st">"CMJ~JH"</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_FZVmx"</span>,        <span class="st">"CMJ~FT:CT"</span>,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_FTCT.mx"</span>,      <span class="st">"CMJ~FT:CT"</span>,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_tm_CV_SMF1"</span>,   <span class="st">"HI-IR~Dur"</span>,</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_mu.vel_CV_SMF1"</span>,<span class="st">"HI-IR~Vel"</span>,</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_logAdj_pl.up"</span>, <span class="st">"HI-IR~PL[VT]"</span>,</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_logAdj_pl.fwd"</span>,<span class="st">"HI-IR~PL[AP]"</span>,</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_logAdj_pl.side"</span>,<span class="st">"HI-IR~PL[ML]"</span>,</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_HRmu_perc"</span>,    <span class="st">"CF-SMFT~HR[ex]"</span>,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_pl.up_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[V]"</span>,</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_pl.fwd_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[AP]"</span>,</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>    dependent_var <span class="sc">==</span> <span class="st">"Zscr_BT_pl.side_CV_SMR1"</span>,<span class="st">"CF-SMFT~PL[ML]"</span>,</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">default =</span> dependent_var   <span class="co"># keep original if no match</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>][var <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"s(Zscr_WI_TD_acu7)"</span>),]</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a><span class="co">#View(plot_data)</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>plt2_dat <span class="ot">=</span>plot_data[,.(dependent_var,dv,var,sample_proportion,edf,<span class="st">`</span><span class="at">p-value</span><span class="st">`</span>)</span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>                    ][,sample_proportion<span class="sc">:</span><span class="er">=</span><span class="fu">as.factor</span>(sample_proportion),</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>                    ]<span class="sc">|&gt;</span><span class="fu">melt.data.table</span>(.SD,<span class="at">id.vars=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>plt2_dat_sig <span class="ot">&lt;-</span> </span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>  plt2_dat[variable <span class="sc">==</span> <span class="st">"p-value"</span>,</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>][,sig_flag <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">"n.s"</span>, <span class="st">"sig"</span>)</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>][,<span class="fu">dcast.data.table</span>(.SD,dependent_var<span class="sc">+</span>dv<span class="sc">+</span>sample_proportion<span class="sc">~</span>sig_flag)</span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dcast.data.table(.SD, dependent_var + dv + sample_proportion ~ :
'fun.aggregate' is NULL, but found duplicate row/column combinations, so
defaulting to length(). That is, the variables [dependent_var, dv,
sample_proportion, sig_flag] used in 'formula' do not uniquely identify rows in
the input 'data'. In such cases, 'fun.aggregate' is used to derive a single
representative value for each combination in the output data.table, for example
by summing or averaging (fun.aggregate=sum or fun.aggregate=mean,
respectively). Check the resulting table for values larger than 1 to see which
combinations were not unique. See ?dcast.data.table for more details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>plt2_dat_sig <span class="ot">&lt;-</span> plt2_dat_sig[,event_rate <span class="sc">:</span><span class="er">=</span> sig<span class="sc">/</span><span class="dv">100</span>][,variable<span class="sc">:</span><span class="er">=</span><span class="st">"p-value"</span>]</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plt2_dat,<span class="fu">aes</span>(sample_proportion,value,<span class="at">group=</span>sample_proportion))<span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(plt2_dat_sig,</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping=</span><span class="fu">aes</span>(sample_proportion,<span class="fl">0.85</span>,</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="fu">paste</span>(event_rate)),</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span><span class="co">#paste0(n.s,"/100"))))+</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_hline</span>(</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.table</span>(<span class="at">variable =</span> <span class="st">"p-value"</span>, <span class="at">value =</span> <span class="fl">0.05</span>),</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fl">0.05</span>),</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"blue"</span>,</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour =</span> <span class="st">"gray30"</span>))<span class="sc">+</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(variable<span class="sc">~</span>dv,<span class="at">scales=</span><span class="st">"free"</span>,<span class="at">labeller =</span> label_parsed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_hline(data = data.table(variable = "p-value", value = 0.05), :
Ignoring unknown parameters: `inherit.aes`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="temporal-effects" class="level2">
<h2 class="anchored" data-anchor-id="temporal-effects">Temporal effects</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>temp_sum<span class="ot">=</span> edf_bind<span class="sc">|&gt;</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fsubset</span>(<span class="fu">grepl</span>(<span class="st">"Week"</span>,contrast))<span class="sc">|&gt;</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fsubset</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"ID"</span>,contrast))<span class="sc">|&gt;</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fsubset</span>(edf_pvalue<span class="sc">&lt;</span><span class="fl">0.01</span>)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>temp_sum<span class="sc">|&gt;</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()<span class="sc">|&gt;</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">""</span>,<span class="st">""</span>,<span class="st">"gam summary"</span> <span class="ot">=</span> <span class="dv">3</span>))<span class="sc">|&gt;</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
gam summary
</div></th>
</tr>
<tr class="even">
<th style="text-align: left;" data-quarto-table-cell-role="th">DV</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">contrast</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edf_pvalue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_JHIM.mx</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">5.674</td>
<td style="text-align: right;">57.164</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_JHIM.mx</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">2.235</td>
<td style="text-align: right;">19.037</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_FZVmx</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">1.694</td>
<td style="text-align: right;">21.843</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_FTCT.mx</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">4.827</td>
<td style="text-align: right;">21.304</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_FTCT.mx</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">1.752</td>
<td style="text-align: right;">10.927</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_tm_CV_SMF1</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">8.332</td>
<td style="text-align: right;">18.306</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_tm_CV_SMF1</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">8.336</td>
<td style="text-align: right;">33.001</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_mu.vel_CV_SMF1</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">8.749</td>
<td style="text-align: right;">58.122</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_mu.vel_CV_SMF1</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">8.407</td>
<td style="text-align: right;">38.862</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_logAdj_pl.up</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">4.290</td>
<td style="text-align: right;">5.747</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_logAdj_pl.side</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">4.030</td>
<td style="text-align: right;">2.963</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_HRmu_perc</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">2.701</td>
<td style="text-align: right;">20.203</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_pl.fwd_CV_SMR1</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">2.098</td>
<td style="text-align: right;">12.668</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zscr_BT_pl.side_CV_SMR1</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">2.075</td>
<td style="text-align: right;">12.461</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zscr_BT_pl.side_CV_SMR1</td>
<td style="text-align: left;">Week</td>
<td style="text-align: right;">2.490</td>
<td style="text-align: right;">6.564</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>temporalFig<span class="ot">=</span><span class="fu">ggplot</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"Week"</span>,.smooth)<span class="sc">&amp;!</span>DV<span class="sc">==</span><span class="st">"HI-IR~Vel"</span>,],</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(value,.estimate,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin=</span>.lower_ci,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax=</span>.upper_ci,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span>.smooth))<span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"rect"</span>,<span class="at">xmin =</span> <span class="sc">-</span><span class="cn">Inf</span>,<span class="at">xmax=</span><span class="cn">Inf</span>,<span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.3</span>,<span class="at">ymax=</span><span class="fl">0.3</span>,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha=</span>.<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="at">size=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span>.<span class="dv">5</span>,<span class="at">col=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Between athlete scaled Estimate"</span>,<span class="at">x=</span><span class="st">"Week"</span>)<span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>DV,<span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour=</span><span class="st">"black"</span>),</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>HIIRvel_temp <span class="ot">&lt;-</span><span class="fu">ggplot</span>(pltDat[<span class="fu">grepl</span>(<span class="st">"Week"</span>,.smooth)<span class="sc">&amp;</span>DV<span class="sc">==</span><span class="st">"HI-IR~Vel"</span>,],</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(value,.estimate,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin=</span>.lower_ci,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymax=</span>.upper_ci,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span>.smooth))<span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"rect"</span>,<span class="at">xmin =</span> <span class="sc">-</span><span class="cn">Inf</span>,<span class="at">xmax=</span><span class="cn">Inf</span>,<span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.3</span>,<span class="at">ymax=</span><span class="fl">0.3</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha=</span>.<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Between athlete scaled Estimate"</span>,<span class="at">x=</span><span class="st">"Week"</span>)<span class="sc">+</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>DV,<span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">colour=</span><span class="st">"black"</span>),</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Times"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(temporalFig,HIIRvel_temp,<span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">0.7</span>,<span class="fl">0.3</span>),<span class="at">common.legend =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>